2006-05-11  Neal H. Walfield  <neal@gnu.org>

	* month_view.c (gtk_month_view_reload_events): Let mktime
	compensate for DST.
	* event-ui.c (click_ok): Likewise.

2006-05-11  Neal H. Walfield  <neal@gnu.org>

	* main.c: Don't include <sys/types.h>, <stdio.h> or <unistd.h>.
	* day_view.c: Don't include <sys/types.h>, <stdio.h>, <stdlib.h>,
	<gpe/stylus.h>, "gtkdatesel.h", "event-cal.h" or "event-list.h".
	* week_view.c: Don't include <sys/types.h>, <gpe/stylus.h>,
	"gtkdatesel.h", "event-cal.h" or "event-list.h".
	* month_view.c: Don't include <sys/types.h>, "event-ui.h" or
	"gtkdatesel.h".
	(is_today): Don't define.

2006-05-11  Neal H. Walfield  <neal@gnu.org>
	Reported by Koen Kooi  <koen@dominion.kabel.utwente.nl>

	* day_render.c (gtk_day_render_expose): Display the lines
	separating the hours when the Bain's line is not present.

2006-05-11  Neal H. Walfield  <neal@gnu.org>

	* event-cal.c (update_cal): Freeze and thaw CAL for old versions
	of Gtk+.

2006-05-11  Neal H. Walfield  <neal@gnu.org>

	* main.c (main): If the import filename is a relative filename,
	create an absolute file name.

2006-05-11  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (calc_events_positions): Free ROOT.

2006-05-11  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (do_import_vevent): Ignore the allday property.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (extract_time): Fix timezone calculation logic.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* main.c (main): Start with 7/8's of the screen's width and
	height, not half.  If LANDSCAPE is FALSE, make PRIMARY a
	GtkVPaned.  Conditionalize the calendar and event box on TINY, not
	on LANDSCAPE.  If LANDSCAPE is FALSE, make SIDEBAR a a GtkHPaned.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (do_import_vevent): Get and set the recurrence
	increment (i.e. iCal's interval).
	
2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (extract_time): Take into account that
	DT->TIMEZONE may be MIMEDIR_DATETIME_NOTZ or MIMEDIR_DATETIME_UTC.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (do_import_vevent): Set EV to NULL.  Support days
	of the week for weekly recurrences.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (gtk_day_render_expose): Subtract one from END.
	* day_view.c (gtk_day_view_reload_events): The day ends before
	midnight, not at midnight.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* month_view.c (gtk_month_view_reload_events): Sort the results of
	event_db_list_for_period.
	* week_view.c (gtk_week_view_reload_events): Likewise.

2006-05-10  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (extract_time): New function.
	(do_import_vevent): Use it rather than mimedir_datetime_get_time_t
	to get the time.  Check if EVENT is an all day event, if so, mark
	as untimed.  Don't unref RECURRENCE.

2006-05-09  Neal H. Walfield  <neal@gnu.org>

	* import-vcal.c (parse_date): Remove function.
	(do_import_vevent): Rewrite.

	* main.c (import_one_file): Call update_view after loading a
	calendar.

	* event-cal.c (update_cal): T is the last valid second, not first
	invalid second.

2006-05-09  Neal H. Walfield  <neal@gnu.org>

	* day_view.c (delete_event_cb): Synchronize with libevent-db API
	changes.
	* event-ui.c (click_delete): Likewise.
	(click_ok): Likewise.
	(edit_event): Likewise.
	* import-vcal.c (do_import_vevent): Likewise.

2006-05-09  Neal H. Walfield  <neal@gnu.org>

	* event-list.c (gtk_event_list_reload_events): Sort
	EVENT_LIST->EVENTS.
	* main.c (alarms_process_pending): Sort LIST.

2006-05-09  Neal H. Walfield  <neal@gnu.org>

	* main.c (schedule_wakeup): Don't cache the event, we only need
	the uid.

2006-05-09  Neal H. Walfield  <neal@gnu.org>

	* day_view.c (gtk_day_view_reload_events): When an event is not
	needed, dereference it immediately.  Free EVENTS.

2006-05-09  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (event_ends): Remove define.
	(found_node): Remove variable.
	(make_set): Likewise.
	(events_overlap): Likewise.
	(find_set_in_list): Likewise.
	(find_set): Likewise.
	(union_set): Likewise.
	(find_overlapping_sets): Likewise.
	(ol_sets_to_rectangles): Likewise.
	(calc_events_positions): New function: new rectangle layout
	implementation.
	(gtk_day_render_set_events): Don't call ol_sets_to_rectangles,
	call calc_events_positions.
	(event_rect_new): Take the X and WIDTH position as arguments
	rather than calculating them here.  Add the newly created
	rectangle to DAY_RENDER->EVENT_RECTANGLES.
	
2006-05-08  Neal H. Walfield  <neal@gnu.org>

	* event-ui.h (unschedule_alarm): Remove declaration.  Update
	callers.
	(schedule_next): Likewise.
	* event-ui.c: Don't include <gpe/schedule.h>.
	(unschedule_alarm): Remove function.
	(schedule_next): Likewise.
	(click_ok): When cancelling the creation of a new an event, also
	call event_remove.
	* configure.ac (DEP_MODULES): Add libhandoff dependency.
	* Makefile.am (gpe_calendar_SOURCES): Add alarm-dialog.c and
	alarm-dialog.h.
	* alarm-dialog.c: New file.
	* alarm-dialog.h: New file.
	* main.c: Include <gpe/schedule.h>, <handoff.h> and
	"alarm-dialog.h".
	(gpe_calendar): New variable.
	(alarm_button): New variable.
	(schedule_wakeup): New function.
	(update_view): Call schedule_wakeup.
	(alarm_dialog): New variable.
	(alarm_dialog_show_event): New function.
	(alarm_dialog_required): New function.
	(alarm_fired): New function.
	(alarms_process_pending): New function.
	(alarm_button_clicked): New function.
	(gpe_cal_exit): Don't call schedule_next.
	(create_app_menu): Create new item, "Alarms".
	(import_file): New function.
	(handoff_callback): New function.
	(handoff_serialize): New function.
	(main): After creating EVENT_DB, add an idle source to call
	alarms_process_pending and another to call schedule_wakeup.  Move
	option parsing earlier.  While parsing option, collect the files
	to import in STATE and in IMPORT_FILES.  Create a handoff object.
	Add a new vertical separator and a new button, "Alarms," to the
	toolbar.  When importing files, call import_file.  Only initialize
	VIEWTIME if not already initialized.
	* day_view.c: Don't include <gpe/schedule.h>.

2006-05-08  Philip Blundell  <pb@reciva.com>

	* main.c (update_view): Don't attempt to update nonexistent widgets.
	(month_view_button_clicked): Likewise.
	(week_view_button_clicked): Likewise.	
	(day_view_button_clicked): Likewise.	
	(propagate_time): Likewise.
	(main): Move calendar creation inside if-block.

2006-05-06  Phil Blundell  <pb@reciva.com>

	* configure.ac: Require libeventdb >= 0.29.

	* main.c (main): Suppress sidebar on small or portrait-format
	screens.

2006-04-25  Neal H. Walfield  <neal@gnu.org>

	* week_view.c (gtk_week_view_reload_events): Call
	event_db_list_for_period, not event_db_list_untimed_for_period.

2006-04-25  Neal H. Walfield  <neal@gnu.org>

	* event-ui.c: Synchronize libeventdb API changes to
	event_get_untimed and event_set_untimed.
	* globals.h: Likewise.
	* import-vcal.c: Likewise.
	* week_view.c: Likewise.

2006-04-24  Neal H. Walfield  <neal@gnu.org>

	* main.c (main): Make PRIMARY a pane, not a box.  Update users.
	Don't create SEP.

2006-04-24  Neal H. Walfield  <neal@gnu.org>

	* event-list.c (gtk_event_list_base_class_init): Correctly
	initialize PARENT_CLASS.

2006-04-24  Neal H. Walfield  <neal@gnu.org>
	Reported by Jan Arne Petersen.

	* event-ui.c (edit_event): Make S->RADIOBUTTONENDAFTER active if
	appropriate.  Initialize S->ENDSPIN to R->COUNT.

2006-04-24  Neal H. Walfield  <neal@gnu.org>

	* event-ui.c (edit_event): Set S->PAGE as a function of the result
	of is_reminder, not event_get_duration.  Invert the logic used to
	set S->REMINDERTIMEBUTTON.

2006-04-24  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (gtk_day_render_button_press): Take into account
	the minimum event rectangle height.

2006-04-24  Neal H. Walfield  <neal@gnu.org>

	* event-ui.c (click_delete): Use event_is_recurrence to check if
	an event is a recurrence.
	(click_ok): Remove unused variables new_event and was_recur.  Use
	event_get_recurrence_start to get the start of the recurrence
	rather than event_get_start.  Use event_set_recurrence_start to
	set the start of the recurrence.
	(edit_event): Use event_get_recurrence_start to get the start of
	the recurrence rather than event_get_start.  Use
	event_get_recurrence_type rather then checking R->TYPE.

2006-04-24  Neal H. Walfield  <neal@gnu.org>

	* event-ui.c (build_edit_event_window): Add HBOXENDAFTER to
	VBOXEND.  Change the ENDLABEL text to "recurrences".

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* day_render.c: Include <libintl.h>.
	(_): Define.
	
2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* week_view.c (gtk_week_view_reload_events): Update call to
	event_db_untimed_list_for_period to reflect new API.

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (gtk_day_render_expose): Don't forget to free
	UNTIL.

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (gtk_day_render_expose): If the event doesn't end
	during the displayed period, include text about when it does ends.

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* event-list.c (gtk_event_list_reload_events): Correctly calculate
	NEXT_RELOAD.
	
2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* week_view.c (gtk_week_view_reload_events): Move code which
	calculates WEEK_VIEW->BANNER_WIDTH and WEEK_VIEW->TIME_WIDTH from
	here...
	(draw_expose_event): ... to here.  Only calculate them if
	WEEK_VIEW->HAVE_EXTENTS is FALSE.

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* event-cal.c: Include <string.h>.
	(update_cal): Make year, month and day unsigned.

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* month_view.c (WIDTH_DELTA): Don't define.
	(gtk_month_view_realize): New function.  Calculate
	MONTH_VIEW->TITLE_HEIGHT here using the average font height.
	(gtk_month_view_base_class_init): Set WIDGET_CLASS->REALIZE to
	gtk_month_view_realize.
	(calc_title_height): Remove function.
	(resize_table): Don't include WIDTH_DELTA when calculating the
	width.
	(gtk_month_view_new): Don't call calc_title_height.

2006-04-23  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (gtk_day_render_base_class_init): Set
	widget_class->size_request to GTK_DAY_RENDER_SIZE_REQUEST.
	(gtk_day_render_size_request): New function, calculate
	DAY_RENDER->ROW_HEIGHT_MIN here.
	(gtk_day_render_expose): Calculate time_width here as required.
	Rearrange code so that there is no penalty.
	(gtk_day_render_update_extents): Don't calc
	DAY_RENDER->ROW_HEIGHT_MIN or DAY_RENDER->TIME_WIDTH here.  Don't
	request a window size unless the widget has already received a
	size request event.

2006-04-22  Neal H. Walfield  <neal@gnu.org>

	* gtkdatesel.c (struct _GtkDateSel): Remove fields day_width,
	month_width, year_width, week_width.

	(get_max_month_width): Remove function.
	(gtk_date_sel_set_month_style): Don't call get_max_month_width.

	(month): New function.
	(GTK_TYPE_MONTH_CELL_RENDERER): New macro.
	(MonthCellRendererClass): New structure.
	(MonthCellRenderer): Likewise.
	(month_cell_renderer_get_type): New function.
	(month_cell_renderer_class_init): Likewise.
	(month_cell_renderer_finalize): Likewise.
	(get_layout): Likewise.
	(month_cell_renderer_get_size): Likewise.
	(month_cell_renderer_render): Likewise.
	(month_cell_renderer_new): Likewise.
	(month_cell_data_func): Change to use the MonthCellRenderer.
	(gtk_date_sel_new): Use a MonthCellRenderer, not a GtkListStore.

2006-04-17  Neal H. Walfield  <neal@gnu.org>

	* month_view.c (draw_expose_event): Turn word wrap off when
	vertical space is at a premium.

2006-04-17  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (struct _GtkDayRender): Add field hour_bar_pos.
	Rename row_height to row_height_min and update users.
	(HOUR_BAR_HEIGHT): New macro.
	(hour_bar_calc): New function.
	(hour_bar_move): Don't simply queue a redraw: calculate where the
	hour bar will be and save it in DAY_RENDER->HOUR_BAR_POS.  Only
	redraw the areas that are damaged.  Only return TRUE if the hour
	bar still needs to be drawn.
	(gtk_day_render_expose): Don't recalculate the hour bar position
	here, just use DAY_RENDER->HOUR_BAR_POS.  Don't set or remove the
	timer.  Be careful not to paint the vertical line separating rows
	over the hour bar.
	(gtk_day_render_update_extents): Call hour_bar_calc.

	(gtk_day_render_expose): Set PL's wrap attribute to
	PANGO_WRAP_WORD_CHAR.  When space is at a premium, try to show
	more text in various ways.  Vertically center the text.  Really
	only print the colon when location or description are present.

	(gtk_day_render_update_extents): Get the logical extents, not the
	ink extents when calculating WIDTH and HEIGHT.  Don't special case
	hildon.  Add 4 extra pixels to the height, not 6.

	* day_render.h (gtk_day_render_set_events): Take new paramter
	date, update callers.
	(gtk_day_render_set_date): Remove declaration.
	* day_render.c (gtk_day_render_set_events): Take a new parameter,
	date.
	(gtk_day_render_update_extents): Remove function.

	* gtkdatesel.c (gtk_date_sel_new): Set the month combo box to have
	three columns.
	
	* week_view.c (REALLY_MIN_CELL_HEIGHT): Remove unused define.

2006-04-16  Neal H. Walfield  <neal@gnu.org>

	* event-list.c (button_press): If there is no row at the cursor
	position, just return.

2006-04-13  Neal H. Walfield  <neal@gnu.org>

	* day_popup.c: Synchronize libeventdb API changes.
	* day_render.c: Likewise.
	* day_view.c: Likewise.
	* event-cal.c: Likewise.
	* event-list.c: Likewise.
	* event-ui.h: Likewise.
	* event-ui.c: Likewise.
	* export-vcal.h: Likewise.
	* export-vcal.c: Likewise.
	* globals.h: Likewise.
	(event_db): New declaration.
	(get_cloned_ev): Remove define.
	* main.c: Synchronize libeventdb API changes.
	(CALENDAR_FILE): New macro.
	(event_db): New variable.
	(on_import_vcal): Don't call event_db_refresh.
	(main): Initialize EVENT_DB.
	* month_view.c: Synchronize libeventdb API changes.
	* week_view.c: Likewise.

	* import-vcal.c: Include <gpe/event-db.h> and "globals.h".
	(CALENDAR_DB_NAME): Remove define.
	(parse_date): New function, imported from libevent-db.
	(do_import_vevent): Don't open an sqlite session, insert directly
	into EVENT_DB using the libeventdb API.

	* day_render.c (gtk_day_render_set_events): Destroy
	DAY_RENDER->EVENT_RECTANGLES.
	* event-cal.c (update_cal): Clear START_TM to 0.

2006-04-10  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (gtk_day_render_expose): Also print the
	EVD->LOCATION and EVD->DESCRIPTION.

2006-04-10  Neal H. Walfield  <neal@gnu.org>

	* day_render.c (struct _GtkDayRender): New fields time_gc and
	hour_bar_repaint.
	(gtk_day_render_finalize): Deallocate DAY_RENDER->TIME_GC and
	DAY_RENDER->HOUR_BAR_REPAINT if required.
	(hour_bar_move): New function.
	(gtk_day_render_expose): If the displayed day contains the current
	time, draw an hour bar and set up a timer to update it.

2006-04-09  Neal H. Walfield  <neal@gnu.org>

	* day_view.c (delete_event_cb): Call update_view, not
	gtk_day_view_reload_events.

	* event-list.c: Include <gdk/gdkkeysyms.h>.
	(key_press): New function.
	(gtk_event_list_init): Connect key_press to EVENT_LIST->VIEW's
	"key_press_event" signal handler.

	* main.c (set_time_and_day_view): Call propagate_time.

	* month_view.c (month_view_key_press_event): If I is non-zero,
	always call gtk_view_set_time.

2006-04-09  Neal H. Walfield  <neal@gnu.org>

	* main.c (propagate_time): New declaration.
	(update_view): Always call gtk_event_cal_reload_events.  Also call
	gtk_event_list_reload_events.

	(set_today): Call propagate_time, not update_view.

	* event-list.c (gtk_event_list_init): Set "scale" on RENDERER to
	0.8.

	(gtk_event_list_reload_events): Rename next_change to next_reload.
	Initialize it to two days in the future.  Simply code given that
	NEXT_RELOAD is initialized.

	* month_view.c (gtk_month_view_new): Make MONTH_VIEW->DRAW
	focusable.
	* week_view.c (gtk_week_view_new): Likewise for WEEK_VIEW->DRAW.

2006-04-09  Neal H. Walfield  <neal@gnu.org>

	* gtkdatesel.h (gtk_date_sel_set_mode): New declaration.
	* gtkdatesel.c (make_field): Show ARROW_L, ARROW_R,
	ARROW_BUTTON_L, E->DISPLAY and ARROW_BUTTON_R.
	(show_field): Remove function.
	(gtk_date_sel_show): Remove function.
	(gtk_date_sel_class_init): Don't initialize WIDGET_CLASS->SHOW.
	(gtk_date_sel_set_mode): New function.
	(gtk_date_sel_new): Create all four fields independent of MODE.
	Call gtk_date_sel_set_mode to show only those required for MODE.
	* main.c (view_button_clicked): Remove function.
	(day_view_button_clicked): New function.
	(week_view_button_clicked): New function.
	(month_view_button_clicked): Also call gtk_date_sel_set_mode to
	change DATESEL to the appropriate mode.
	(main): Connect DAY_BUTTON's clicked callback to
	day_view_button_clicked.  Connect WEEK_BUTTON's clicked callback
	to week_view_button_clicked.

2006-04-09  Neal H. Walfield  <neal@gnu.org>

	* view.h: New file.
	* view.c: New file.
	* Makefile.am (gpe_calendar_SOURCES): Add view.c and view.h.
	* main.c: Include "view.h", "event-cal.h" and "event-list.h".
	(datesel, calendar, event_list): New global variables.
	(update_view): Don't look up the "update_hook" on the view, call
	gtk_view_reload_events.  Also call gtk_event_cal_reload_events.
	(propagate_time): New function.
	(datesel_changed): New function.
	(calendar_changed): New function.
	(time_changed): New function.
	(new_view): When invoking NEW, pass VIEWTIME.  Connect
	time_changed to the new view's "time-changed" signal.
	(view_button_clicked): Show CALENDAR.
	(month_view_button_clicked): New function.
	(main): Limit WINDOW_X to 1000 and WINDOW_Y to 800.  Incorporate
	CALENDAR, DATESEL and EVENT_LIST into the layout.
	* day_view.h (gtk_day_view_new): Accept new parameter, time.
	Update callers.
	* day_view.c: Include "view.h".
	(struct _GtkDayView): Make widget not a GtkVBox but a GtkView.
	Remove fields datesel, calendar, event_list, event_box and date
	and update users.
	(DayViewClass): Remove field vbox_class, add field view_class.
	(gtk_day_view_show): Remove declaration.
	(day_view_update): Likewise.
	(gtk_day_view_set_time): New declaration.
	(gtk_day_view_reload_events): Likewise.
	(gtk_day_view_get_type): Inherit from a GtkView, not a GtkVBox.
	(gtk_day_view_base_class_init): Likewise.  Don't initialize
	WIDGET_CLASS->SHOW.  Initialize VIEW_CLASS->SET_TIME to
	gtk_day_view_set_time and VIEW_CLASS->RELOAD_EVENTS to
	GTK_RELOAD_EVENTS.
	(gtk_day_view_init): Don't initialize DAY_VIEW->DATE.
	(gtk_day_view_show): Remove function.
	(gtk_day_view_set_time): New function.
	(day_view_row_clicked): Don't use VIEWTIME, use the date stored in
	DAY_VIEW.
	(day_view_update): Rename from this...
	(gtk_day_view_reload_events): ... to this and update callers.
	Remove force parameter.  Don't check if we need to update; assume
	that we do.
	(datesel_changed): Remove function.
	(calendar_changed): Remove function.
	(scroll_to): Don't use VIEWTIME, use the date stored in DAY_VIEW.
	(event_menu_destroy): Remove function.
	(gtk_day_view_new): Accept new parameter, time.  Don't set the
	"update_hook" data on DAY_VIEW.  Don't create a datesel, calendar
	or event_list and refactor layout accordingly.
	* day_render.h: Don't require a GdkGC * but a GdkColor.  Update
	users.
	* day_render.c (struct _GtkDayRender): New field, app.  Rename
	normal_gc to app_gc and update users.
	(gtk_day_render_new): Don't require a GdkGC * but a GdkColor.
	Assign this to DAY_RENDER->APP.
	(gtk_day_render_expose): And allocate DAY_RENDER->APP_GC here when
	needed.
	* week_view.h (gtk_week_view_new): Accept new parameter, time.
	Update callers.
	* week_view.c: Include "view.h".
	(struct _GtkWeekView): Make widget a GtkView, not a GtkVBox.
	(struct _GtkWeekView): Remove fields datesel, calendar, event_list
	and date and update users.
	(GtkWeekViewClass): Remove field vbox_class, add field view_class.
	(gtk_week_view_show): Remove declaration.
	(week_view_update): Likewise.
	(gtk_week_view_set_time): New declaration.
	(gtk_week_view_reload_events): Likewise.
	(gtk_week_view_get_type): Inherit from a GtkView, not a GtkVBox.
	(gtk_week_view_base_class_init): Likewise.  Don't initialize
	WIDGET_CLASS->SHOW.  Set VIEW_CLASS->SET_TIME to
	gtk_month_view_set_time and VIEW_CLASS->RELOAD_EVENTS to
	gtk_month_view_reload_events.
	(gtk_week_view_init): Don't initialize WEEK_VIEW->DATE.
	(gtk_week_view_show): Remove function.
	(gtk_week_view_set_time): New function.
	(week_view_update): Rename from this...
	(gtk_week_view_reload_events): ... to this.  Remove parameter
	force; always update.  Don't update WEEK_VIEW->CALENDAR or
	WEEK_VIEW->DATESEL.  Don't use VIEWTIME, use the date in
	MONTH_VIEW.
	(calendar_day_changed): Remove function.
	(datesel_changed): Likewise.
	(update_hook_callback): Likewise.
	(week_view_key_press_event): Don't update WEEK_VIEW->DATESEL, call
	gtk_view_set_time.  Don't use VIEWTIME, use the time in WEEK_VIEW.
	(week_view_button_press): Likewise.
	(gtk_week_view_new): Take new parameter, time.  Don't set the
	"update_hook" data on WEEK_VIEW.  Don't create a datesel, calendar
	or event_list and refactor layout accordingly.
	* month_view.h (gtk_month_view_new): Accept new parameter, time.
	Update callers.
	* month_view.c: Include "view.h".
	(struct _GtkMonthView): Make widget a GtkView, not a GtkVBox.
	Remove field datesel and date and update users.
	(GtkMonthViewClass): Remove field vbox_class, add field
	view_class.
	(gtk_month_view_show): Remove declaration.
	(month_view_update): Likewise.
	(gtk_month_view_set_time): New declaration.
	(gtk_month_view_reload_events): Likewise.
	(gtk_month_view_get_type): Inherit from a GtkView, not a GtkVBox.
	(gtk_month_view_base_class_init): Likewise.  Don't initialize
	WIDGET_CLASS->SHOW.  Set VIEW_CLASS->SET_TIME to
	gtk_month_view_set_time and VIEW_CLASS->RELOAD_EVENTS to
	gtk_month_view_reload_events.
	(gtk_month_view_init): Don't initialize MONTH_VIEW->DATE.
	(gtk_month_view_show): Remove function.
	(gtk_month_view_set_time): New function.
	(button_press): Don't use VIEWTIME, change MONTH_VIEW->FOCUSED_DAY
	or change the focus; just call gtk_view_set_time.
	(month_view_key_press_event): Likewise.
	(month_view_update): Rename from this...
	(gtk_month_view_reload_events): ... to this.  Remove parameter
	force; always update.  Don't update MONTH_VIEW->DATESEL.  Don't
	use VIEWTIME, use the date in MONTH_VIEW.
	(datesel_changed): New function.
	(update_hook_callback): New function.
	(gtk_month_view_new): Take new parameter, time.  Don't realize
	MAIN_WINDOW.  Don't set the "update_hook" data on MONTH_VIEW.
	Don't create a datesel and refactor layout accordingly.

2006-04-09  Neal H. Walfield  <neal@gnu.org>

	* event-cal.c (update_cal): Check if the date changed using the
	year and month in the GtkEventCal, not the GtkCalendar.

2006-04-09  Neal H. Walfield  <neal@gnu.org>

	* event-list.c (struct _GtkEventList): Add fields date and tm.
	(date_cell_data_func): Interpret user data as the associated
	GtkEventList.  Provide more descriptive dates.
	(gtk_event_list_init): Pass EVENT_LIST as user data to
	date_cell_data_func.
	(gtk_event_list_reload_events): Save the time in EVENT_LIST->DATE
	and EVENT_LIST->TM.  Don't just look for the end of the next
	event: find the first status change.

2006-04-08  Neal H. Walfield  <neal@gnu.org>

	* gtkdatesel.c (get_max_day_width): Remove dead code.

2006-04-08  Neal H. Walfield  <neal@gnu.org>

	* event-list.h: New file.
	* event-list.c: New file.
	* Makefile.am (gpe_calendar_SOURCES): Add event-list.c and
	event-list.h.
	* day_view.c: Include "event-list.h".
	(struct _GtkDayView): New field, event_list.
	(day_view_update): If FORCE is true, cause DAY_VIEW->EVENT_LIST
	to reload.
	(gtk_day_view_new): Initialize DAY_VIEW->EVENT_LIST.  Add
	DAY_VIEW->EVENT_LIST just below DAY_VIEW->CALENDAR.
	* week_view.c: Include "event-list.h".
	(struct _GtkWeekView): New field, event_list.
	(week_view_update): If FORCE is true, cause WEEK_VIEW->EVENT_LIST
	to reload.
	(gtk_week_view_new): Initialize WEEK_VIEW->EVENT_LIST.  Add
	WEEK_VIEW->EVENT_LIST just below WEEK_VIEW->CALENDAR.

2006-04-07  Florian Boor  <florian@kernelconcepts.de>

    * event-ui.c (build_edit_event_window): Nicer looking layout: replace 
      boxes with table.
    
2006-04-06  Neal H. Walfield  <neal@gnu.org>

	* event-cal.h: New file.
	* event-cal.c: New file.
	* Makefile.am (gpe_calendar_SOURCES): Add event-cal.c and
	event-cal.h.
	* day_view.c: Include "event-cal.h".
	(day_view_update): If force is true, make DAY_VIEW->CALENDAR
	reread the event database.
	* week_view.c: Include "event-cal.h".
	(week_view_update): If force is true, make WEEK_VIEW->CALENDAR
	reread the event database.
	(gtk_week_view_new): Make a GtkEventCal, not a GtkCalendar.

2006-04-06  Neal H. Walfield  <neal@gnu.org>

	* main.c (today_button): Remove global variable.
	(force_today): Make this global static...
	(set_today): ... a local static in this function.  Only revert to
	the saved time if the current view is today.  Otherwise, just go
	to today.
	(main): Don't make the today button a toggle.
	* globals.h (force_today): Remove declaration.
	* month_view.c (draw_expose_event): Don't check force_today.

2006-04-06  Neal H. Walfield  <neal@gnu.org>

	* main.c (notebook): Remove variable.
	(view_container): New variable.
	(day): Remove variable.
	(week): Likewise.
	(month): Likewise.
	(set_time_all_views): Remove function.
	(update_view): Don't pass the view to update as a parameter, just
	use CURRENT_VIEW.
	(update_current_view): Remove function.
	(update_all_views): Likewise.
	(set_today): Don't call set_time_all_views but update_view.
	(new_view): Rewrite to accept a constructor function as the
	argument.  If CURRENT_VIEW is non-NULL, destroy.  Invoke the
	constructor, add the resulting widget to VIEW_CONTAINER and show
	it.
	(set_time_and_day_view): Don't call update_current_view.
	(button_toggled): Rename from this...
	(view_button_clicked): ... to this.  Update users.
	(on_import_vcal): Don't call update_all_views but update_view.
	(main_window_key_press_event): Remove function.
	(main): Don't create a GtkNotebook but a GtkVBox.  Don't create a
	GtkDayView, GtkWeekView or GtkMonthView.  Pass gtk_day_view_new as
	the user data argument to the click call back of the day view
	button.  Likewise gtk_week_view_new for the week view button and
	gtk_month_view_new for the month view button.  Don't call
	update_all_views.  Pass gtk_day_view_new as the parameter to
	new_view.
	* globals.h (update_view): New declaration.
	(update_current_view): Remove declaration.
	(update_all_views): Remove declaration.
	(set_time_all_views): Remove declaration.
	* gtkdatesel.h (gtk_date_sel_new): Take new parameter, the initial
	time.
	* gtkdatesel.c (gtk_date_sel_new): Take new parameter, the initial
	time.
	(gtk_date_sel_new): Remove unused variable buffer.
	(gtk_date_sel_new): Call week_update after creating the week
	display, day_update after creating the day display, month_update
	after creating the month display and year_update after creating
	the year display.
	* day_view.h (gtk_day_view_new): Return a GtkWidget *, not a
	GtkDayView *.
	* day_view.c (gtk_day_view_show): New declaration.
	(gtk_day_view_base_class_init): Initialize WIDGET_CLASS->SHOW to
	gtk_day_view_show.
	(gtk_day_view_show): New function.
	(day_view_update): Fold function into...
	(delete_event_cb): ... this function.  Don't call update_all_views
	but day_view_update.
	(day_view_update): Check if DAY_VIEW->DATESEL needs an update.
	Check if DAY_VIEW->CALENDAR needs an update.
	(datesel_changed): Don't update DAY_VIEW->CALENDAR, just always
	call day_view_update.
	(calendar_changed): Don't udpate DAY_VIEW->DATESEL, just always
	call day_view_update.
	(gtk_day_view_new): Return a GtkWidget *, not a GtkDayView *.
	Pass VIEWTIME to gtk_date_sel_new.  Don't set the "datesel-day"
	property on MAIN_WINDOW.
	* week_view.h (gtk_week_view_new): Return a GtkWidget *, not a
	GtkDayView *.
	* week_view.c (gtk_week_view_show): New declaration.
	(week_view_update): Likewise.
	(gtk_week_view_base_class_init): Initialize WIDGET_CLASS->SHOW to
	gtk_week_view_show.
	(gtk_week_view_show): New function.
	(week_view_update): Check if WEEK_VIEW->DATESEL needs to be
	updated.  Check if WEEK_VIEW->DATESEL needs to be updated.
	(calendar_day_changed): Don't udpate DAY_VIEW->DATESEL, just
	always call day_view_update.
	(datesel_changed): Don't update DAY_VIEW->CALENDAR, just always
	call day_view_update.
	(update_hook_callback): Don't update WEEK_VIEW->CALENDAR or
	WEEK_VIEW->DATESEL.
	(gtk_week_view_new): Return a GtkWidget *, not a GtkWeekView *.
	Pass VIEWTIME to gtk_date_sel_new.  Don't set the "datesel-week"
	property on MAIN_WINDOW.
	* month_view.h (gtk_month_view_new): Return a GtkWidget *, not a
	GtkDayView *.
	* month_view.c (gtk_month_view_show): New declaration.
	(month_view_update): Likewise.
	(gtk_month_view_base_class_init): Initialize WIDGET_CLASS->SHOW to
	gtk_month_view_show.
	(gtk_month_view_show): New function.
	(month_view_update): Check if MONTH_VIEW->DATESEL needs to be
	updated.
	(gtk_month_view_new): Return a GtkWidget *, not a GtkMonthView *.
	Don't show MONTH_VIEW.  Pass VIEWTIME to gtk_date_sel_new.  Don't
	set the "datesel-month" property on MAIN_WINDOW.  * event-ui.c
	(click_delete): Don't call update_all_views but update_view.
	(click_ok): Likewise.
	* xsettings.c (notify_func): Likewise.

2006-04-05  Neal H. Walfield  <neal@gnu.org>

	* month_view.c (gtk_month_view_init): Set MONTH_VIEW->HAS_POPUP to
	0.
	(button_press): Likewise as well as POP_WINDOW.
	(month_view_key_press_event): Likewise.

2006-04-05  Neal H. Walfield  <neal@gnu.org>

	* day_view.c (struct _GtkDayView): Add field, date.
	(gtk_day_view_init): Initialize DAY_VIEW->DATE.
	(datesel_changed): Move bulk of code from here...
	(day_view_update): ... to here.  Only update if FORCE is true or
	if the day actually changed.  Free events which are not used.
	(datesel_changed): If time changed, update DAY_VIEW->CALENDAR and
	call day_view_update.
	(day_changed_calendar): Rename from this...
	(calendar_changed): ... to this and update callers.  Don't call
	set_time_all_views.  If time changed, update DAY_VIEW->DATESEL and
	call day_view_update.
	(update_hook_callback): Change return type to void.  Change first
	parameter to a GtkWidget *.  Call day_view_update.
	(gtk_day_view_new): Change return type to GtkDayView *.

	(gtk_day_view_finalize): Don't free DAY_VIEW->APPOINTMENTS or
	DAY_VIEW->REMINDERS.

	* day_view.h (gtk_day_view_new): Change to return a GtkDayView *.
	Update users.

2006-04-05  Neal H. Walfield  <neal@gnu.org>

	* week_view.h (struct _GtkWeekView): New structure.
	(GtkWeekView): New tyepdef.
	(GTK_WEEK_VIEW): New macro.
	(GTK_WEEK_VIEW_CLASS): New macro.
	(GTK_IS_WEEK_VIEW): New macro.
	(gtk_week_view_get_type): New declaration.
	(week_view): Rename from this...
	(gtk_week_view_new): ... to this.  Change return type to
	GtkWeekView *.  Update callers.
	(week_free_lists): Remove declaration.
	* week_view.c: Don't include <stdio.h>, <stdlib.h> or <string.h>.
	(struct render_ctl): Remove this structure.  Add POPUP to...
	(struct week_day): ... this structure.  Rename y0 to top, y1 to
	height.  Rename string to banner.  Remove is_today and is_active.
	Update users.
	(week_view_draw, available_width, c_old, today): Move from here...
	(struct _GtkWeekView): ... to here.  Rename to draw, width and
	has_popup, and date respectively.  Update users.
	(datesel, calendar, time_width, scroller, week_days): Move from
	here...
	(struct _GtkWeekView): ... to here.  Add have_extents,
	banner_width, height and focused_day.
	(GtkWeekViewClass): New structure.
	(gtk_week_view_base_class_init): New declaration.
	(gtk_week_view_init): New declaration.
	(gtk_week_view_dispose): New declaration.
	(gtk_week_view_finalize): New declaration.
	(parent_class): New global static.
	(gtk_week_view_get_type): New function.
	(gtk_week_view_base_class_init): New function.
	(gtk_week_view_init): New function.
	(gtk_week_view_dispose): New function.
	(gtk_week_view_finalize): New function.
	(gtk_week_view_invalidate_day): New function.
	(draw_expose_event): Use pen_new where possible.  Rewrite to more
	precisely draw the days within their respective bounding boxes.
	Don't reserve 1/7 of the screen for each day: only allocate as
	much as needed to maximize use of real estate.  As far as
	possible, only redraw damaged areas.  Don't mark the events, just
	check if the start matches the day we are drawing.  Correctly
	color the days when WEEK_STARTS_MONDAY is false.  Save the
	calculated extents.  Clear any unused drawing area to the
	background color as required.
	(week_free_lists): Remove function.
	(resize): On a change, set WEEK_VIEW->HAVE_EXTENTS as false.
	Queue a redraw of WEEK_VIEW->DRAW.
	(week_view_update): Take two new parameters: a GtkWeekView and a
	boolean which forces an update.  Only update if the week changed
	or we are forced to.  If the week didn't change but the day did,
	change WEEK_VIEW->FOCUSED_DAY and damage the drawing area
	appropriately.  Correctly calculate the start of the week taking
	into account days sometimes have more or less than 24 hours.  When
	creating each day's banner, add a space at the end.  Don't
	calculate the height of each day: do that lazily when drawing the
	view the first time.
	(calendar_day_changed): Don't call set_time_all_views.  Keep
	WEEK_VIEW->DATESEL in sync.  When calling week_view_update, don't
	force an update.
	(datesel_changed): Keep WEEK_VIEW->CALENDAR in sync.  When calling
	week_view_update, don't force an update.
	(update_hook_callback): Require another parameter, a GtkWeekView
	*.  When calling week_view_update, force an update.
	(week_view_key_press_event): All days are valid.  Don't forget to
	set POP_WINDOW to NULL and WEEK_VIEW->HAS_POPUP after destroying
	POP_WINDOW.
	(get_day_from_y): Remove function.
	(week_view_button_press): Use calculated extents.  Rather than on
	a double click, if an focused day is clicked, zoom to that day.
	On focus, give WEEK_VIEW->DRAW the focus.
	(week_view): Rename from this...
	(gtk_week_view_new): ... to this.  Return a GtkWeekView.  Pass
	WEEK_VIEW as user data when setting up the various signal
	handlers.
	* main.c (on_import_vcal): Don't call week_free_lists.

2006-04-03  Neal H. Walfield  <neal@gnu.org>

	* main.c (main): Really update all callers of month_view to call
	gtk_month_view_new.
	
2006-04-03  Neal H. Walfield  <neal@gnu.org>

	* month_view.h (struct _GtkMonthView): New structure.
	(GtkMonthView): New typedef.
	(GTK_MONTH_VIEW): New macro.
	(GTK_MONTH_VIEW_CLASS): New macro.
	(GTK_IS_MONTH_VIEW): New macro.
	(month_view): Rename from this...
	(gtk_month_view_new): ... to this and update callers.
	(month_free_lists): Remove declaration.
	* month_view.c: Don't include <stdio.h>, <stdlib.h> or <string.h>.
	(TOTAL_WEEKS): New macro.
	(WIDTH_DELTA): New macro.
	(is_today): New macro.
	(struct _GtkMonthView): New structure.
	(day_events, datesel, draw, render_ctl, rc): Move from here...
	(struct _GtkMonthView): ... to this structure and update users.
	(c_old, active_day): Move from here...
	(struct _GtkMonthView): ... to this structure, rename to has_popup
	and focused_day respective, and update users.
	(month_view_update): Remove declaration.
	(GtkMonthViewClass): New typedef.
	(gtk_month_view_base_class_init): New declaration.
	(gtk_month_view_init): New declaration.
	(gtk_month_view_dispose): New declaration.
	(gtk_month_view_finalize): New declaration.
	(parent_class): New global.
	(gtk_month_view_get_type): New function.
	(gtk_month_view_base_class_init): New function.
	(gtk_month_view_init): New function.
	(gtk_month_view_dispose): New function.
	(gtk_month_view_finalize): New function.
	(gtk_month_view_cell_box): New function.
	(gtk_month_view_cell_at): New function.
	(gtk_month_view_invalidate_cell): New function.
	(button_press): Don't display the popup menu if C is invalid.  If
	left clicking on a non-focused cell, move to that cell.  If that
	includes changing to a new month, do that.  If clicking on an
	focused cell, move to the day view of that cell.  Don't do this
	for a double click.  Only call month_view_update is really
	necessary.
	(days1, days2): Merge to...
	(days_of_week): ... to this and update users.
	(calc_title_height): Change argument from a GtkWidget to a
	GtkMonthView.  Don't use strlen, just pass -1 to
	pango_layout_set_text.
	(draw_expose_event): Expose the remaining arguments which are
	passed to an expose event.  Precisely draw each event in its area
	avoiding treading on a neighbor.  Only redraw those events which
	require a redraw.  Use pen_new where possible.  Don't waste time
	calling gdk_gc_set_clip_rectangle.  Collapse loops.  Don't forget
	to unref PL_EVT.
	(month_view_update): Take two new parameters, MONTH_VIEW and
	FORCE.  Only update if the month actually changed or if FORCE is
	true.  Compress loops.
	(changed_callback): Rename from this...
	(datesel_changed): ... to this.  The second parameter is a
	GtkMonthView, pass it to month_view_update.
	(update_hook_callback): Take an additional parameter, the view.
	Pass it to month_view_update.
	(resize_table): Add two parameters, the GtkAllocation and the
	GtkMonthView.  Pre-adjust the width with WIDTH_DELTA.  Queue a
	draw, don't actually perform one immediately.
	(month_view_key_press_event): Compress code.  Only call
	month_view_update when required.  When reaching an edge which
	would require scrolling to the next (or previous month), actually
	do it.
	(month_free_lists): Remove function.
	(month_view): Rename funtion...
	(gtk_month_view_new): ... to this.  Pass MONTH_VIEW to the various
	signal handlers as the user data parameter.  Request size based on
	MONTH_VIEW->TITLE_HEIGHT.
	* day_render.h (pen_new): Move declaration from here...
	* globals.h (pen_new): ... to here.
	* day_render.c (pen_new): Move function from here...
	* main.c (pen_new): ... to here.

2006-04-01  Neal H. Walfield  <neal@gnu.org>

        * export-vcal.c (vcal_do_save): Don't connect a signal handler to
        the cancel button which destroys the dialog as we destroy it anyway,
        i.e. avoid a double free.

2006-04-01  Neal H. Walfield  <neal@gnu.org>

        * gtkdatesel.c: Include <gdk/gdkkeysyms.h> and <stdlib.h>.
        (struct elem): Rename field text to display.  Update users.
        (year_update): Change to update the year's GtkEntry.
        (year_key_press): New function.
        (month_change): New function.
        (month_update): Change to update the month's GtkComboBox.
        (day_update): Change to update the day's GtkEntry.
        (day_key_press): New function.
        (entry_button_press): New function.
        (make_field): Require the caller to make sure that E->DISPLAY is
        valid.  Remove argument UPDATE and MAX_WIDTH.  Remove code which
        sets the update signal handler and the width of E->DISPLAY.
        (gtk_date_sel_init): Remove function and integrate functionality
        into...
        (gtk_date_sel_new): ... here.  Only build components required by
        MODE.  Make the day display not a GtkLabel but a GtkEntry, the
        month and year displays not GtkLabel's but GtkComboBox's.  Don't
        wire the maximum width anymore.
        (gtk_date_sel_show): When showing the week view, don't just show
        the week number and the year, also show the month.
        (gtk_date_sel_get_type): Don't provide a GInstanceInitFunc when
        building DATE_SEL_INFO.

2006-04-02  Phil Blundell  <pb@reciva.com>

	* main.c (main): Move time format checking code after setlocale
	call.

2006-03-31  Neal H. Walfield  <neal@gnu.org>

	* day_render.h (gtk_day_render_new): Add new arguments duration,
	rows_hard_first and rows_hard.  Remove arguments cols and ol_gc.
	Update callers.
	* day_render.c (period): Remove define.
	(event_rect_new): Don't mark the DAY_RENDER as const.
	(struct _GtkDayRender): Remove unused field ol_gc and cols.
	Rename width to visible_width and height to visible_height and
	update users.  Add duration, event_earliest, event_latest, height,
	offset_y, rows_hard_first, rows_hard, rows_visible_first and
	rows_visible.  Changed all fields that were a guint to a gint.
	(gtk_day_render_new): Implement initialization for new arguments
	duration, rows_hard_first and rows_hard.  Remove initialization
	for cols and ol_gc.
	(event_rect_draw): Integrated into...
	(gtk_day_render_expose): ... this function.  Make i and top gints,
	not guints.  When iterating over the rows to draw, start with row
	DAY_RENDER->ROWS_VISIBLE_FIRST and paint exactly
	DAY_RENDER->ROWS_VISIBLE rows.  Scale the drawing operations to
	fill the canvas given that only DAY_RENDER->ROWS_VISIBLE rows are
	visible.  Don't draw a line at the bottom of the canvas.
	(gtk_day_render_configure): If UPDATE is true also call
	gtk_day_render_update_extents.
	(gtk_day_render_button_press): Change row calculation to take into
	account the number of rows actually drawn.
	(gtk_day_render_set_events): Reset DAY_RENDER->EVENT_EARLIEST and
	DAY_RENDER->EVENT_LATEST.  Call gtk_day_render_update_extents.
	(gtk_day_render_update_extents): Only update
	DAY_RENDER->ROW_HEIGHT and DAY_RENDER->TIME_WIDTH the first time
	the function is called.  Also compute
	DAY_RENDER->ROWS_VISIBLE_FIRST and DAY_RENDER->ROWS_VISIBLE.
	Request a window size based on the number of visible rows.
	(event_rect_new): Update DAY_RENDER->EVENT_EARLIEST and
	DAY_RENDER->EVENT_LATEST as required.
	* day_view.c (datesel_changed): Remove variable tm_end.  Get the
	list of events for the next 30 hours.  Only add those events that
	happen in the next 24 hours to REMINDERS.  Pass START, not
	VIEWTIME to gtk_day_render_new.

2006-03-28  Neal H. Walfield  <neal@gnu.org>

        Make DayView and DayRender proper gtk objects and cleanly separate
        their functionality.

        * day_view.h (struct _GtkDayView): New struct.
        (GtkDayView): New typedef.
        (GTK_DAY_VIEW): New macro.
        (GTK_DAY_VIEW_CLASS): New macro.
        (GTK_IS_DAY_VIEW): New macro.
        (gtk_day_view_get_type): New declaration.
        (gtk_day_view_new): Renamed from day_view.
        (gtk_day_view_scroll): Renamed from day_view_scroll.
        (struct day_page): Removed struct.
        (day_view_combined_times): Remove declaration.
        (day_view_init): Remove declaration.
        (day_view_button_press): Remove declaration.
        (day_page_t): Removed typedef.
        * day_view.c (rem_area, datesel, calendar, scrolled_window,
        sel_event; page_app, page_rem, dr, rem_render, scrolling,
        scroll_floating): Remove global variables and fold into...
        (struct _GtkDayView): ... this new struct.
        (DayViewClass): New typedef.
        (parent_class): New global variable.
        (day_page_new): Rename to gtk_day_view_new.
        (gtk_day_view_get_type): New function.
        (gtk_day_view_base_class_init): New function.
        (gtk_day_view_init): New function.
        (gtk_day_view_dispose): New function.
        (gtk_day_view_finalize): New function.
        (day_page_draw_background): New function.
        (day_view_button_press): Split function into...
        (day_view_row_clicked): this new function...
        (day_view_event_clicked): and this new function...
        * day_render.c (gtk_day_render_button_press): and this new
        function.
        * day_view.c (day_view_expose): Move function to...
        * day_render.c (gtk_day_render_expose): ...here.
        * day_view.c (reminder_view_expose): Move function to...
        * day_render.c (gtk_day_render_expose): ...here.
        (day_page_draw_empty): Remove function.
        (day_page_calc_time_width): Move from here...
        * day_render.c (gtk_day_render_update_extents): ... to here.
        * day_view.c (day_view_expose_cb): Remove function.
        (reminder_view_init): Move this functionality...
        (reminder_view_expose): and this...
        (day_view_init): and this...
        (day_view_expose): and this...
        (changed_callback): and this...
        (datesel_changed): ... to here.
        (reminder_view_expose_cb): Remove function.
        (day_view_update): Remove function.
        (scroll_to): Update to use a GtkDayView rather than globals.
        (day_view_scroll): Rename...
        (gtk_day_view_scroll): ...to this.  Update to use a GtkDayView
        rather than globals.
        (sink_scroller): Update to use a GtkDayView rather than globals.
        (update_hook_callback): Likewise.
        (event_menu_destroy): Likewise.
        (delete_event_cb): Likewise.
        (edit_event_cb): Likewise.
        (save_cb): Likewise.
        (send_ir_cb): Likewise.
        (send_bt_cb): Likewise.
        (day_view): Split this function into...
        (gtk_event_menu_new): this...
        (gtk_day_view_new): and this.  Update to use a GtkDayView rather
        than globals.
        * day_render.h (day_render_update_offset): Remove macro.
        (caption): Remove structure.
        (struct day_render): Move...
        * day_render.c (struct GtkDayRender): ... here.
        * day_render.h (row): Remove structure.
        (ev_rec): Move...
        * day_render.h (struct event_rect): ... here and make widt,
        height, x and y floats which are percentages of the canvas.
        (struct _GtkDayRender): New struct.
        (GtkDayRender): New typedef.
        (GTK_DAY_RENDER): New macro.
        (GTK_DAY_RENDER_CLASS): New macro.
        (GTK_IS_DAY_RENDER): New macro.
        (day_render_new): Rename to...
        (gtk_day_render_new): ... this.
        (gtk_day_render_get_type): New declaration.
        (gtk_day_render_set_events): New declaration.
        (day_render_delete): Remove.
        (day_render_show): Remove.
        (day_render_show_big): Remove.
        (day_render_find_overlapping): Remove.
        (day_render_event_show_big): Remove.
        (day_render_find_overlapping): Remove.
        (day_render_event_show_big): Remove.
        (day_render_resize): Remove.
        (day_render_set_event_rectangles): Remove.
        (draw_appointments): Remove.
        * day_render.c (find_overlapping_sets): New forward.
        (ol_sets_to_rectangles): Likewise.
        (period): New macro.
        (bell_pb): New global.
        (event_rect_new): New declaration.
        (event_rect_delete): New declaration.
        (event_rect_draw): New declaration.
        (struct _GtkDayRender): New structure.
        (GtkDayRenderClass): New typedef.
        (gtk_day_render_base_class_init): New declaration.
        (gtk_day_render_init): New declaration.
        (gtk_day_render_dispose): New declaration.
        (gtk_day_render_finalize): New declaration.
        (gtk_day_render_expose): New declaration.
        (gtk_day_render_configure): New declaration.
        (gtk_day_render_button_press): New declaration.
        (parent_class): New global.
        (gtk_day_render_get_type): New function.
        (gtk_day_render_base_class_init): New function.
        (day_render_new): Move this functionaltiy from here...
        (gtk_day_render_init): ... to here...
        (gtk_day_render_new): ... and to here.
        (gtk_day_render_dispose): New function.
        (day_render_delete): Move this functionaltiy from here...
        (gtk_day_render_finalize): ... to here.
        (draw_appointments): Integrate functionality into...
        (gtk_day_render_expose): ... to here.
        (gtk_day_render_configure): New function.
        (day_render_set_event_rectangles): Remame to...
        (gtk_day_render_set_events): ... this.
        (gtk_day_render_set_date): New function.
        (show_event): Rename to...
        (event_rect_draw): ... this and calculate the rectangle in terms
        of the new paramters CANVAS_HEIGHT and CANVAS_WIDTH and the
        percentages in EVENT_RECTANGLE.  Also, tune the rectangle to
        exactly fit in the prescribed area.  Load BELL_PB if required.
        (event_rect_new): Calculate x, y, height and width as percentages.
        (event_rect_delete): Add static attribute.
        (ol_sets_to_rectangles): Pretty up code.
        (caption_new): Remove function.
        (caption_delete): Remove function.
        (caption_set_pango): Remove function.
        (caption_show): Remove function.
        (event_starts_today): Remove function.
        (page_height_set): Remove function.
        (day_render_resize): Remove function.
        (event_ends_today): Remove function.
        (day_render_find_overlapping): Remove function.
        (day_render_event_starts): Remove function.
        (day_render_event_show): Remove function.
       * main.c (update_view): Pass VIEW to F.

2006-02-15  Florian Boor <florian.boor@kernelconcepts.de>

    * globals.h, main.c (main): Implement a cleverer solution using the global 
    time formating string.
    * day_view.c (day_page_draw_background): Use better solution.
    (day_page_calc_time_width): likewise
    * week_view.c (draw_expose_event): likewise

2006-02-15  Florian Boor <florian.boor@kernelconcepts.de>

    * day_view.c (day_page_draw_background): Full working support for AM/PM 
    timezones.
    (day_page_calc_time_width): likewise + make column one pixel wider.

2006-02-15  Florian Boor <florian.boor@kernelconcepts.de>

    * day_view.c (day_page_draw_background), (day_page_calc_time_width):
    Support time formating depending on locale setting. Needs additional fix to
    get rid of the seconds.

2006-02-12  Phil Blundell  <pb@reciva.com>

	* Version 0.72 released.

2006-02-12  Phil Blundell  <pb@reciva.com>

	* day_view.c (reminder_view_init): Use
	event_db_untimed_list_for_period.

	* day_render.c (day_render_delete): Call event_db_list_destroy.
	* main.c (on_import_vcal): Don't call day_free_lists.
	* day_view.c (day_free_lists): Deleted.
	(day_events, untimed_events): Likewise.
	* day_view.h (day_free_lists): Likewise.
	
2006-02-07  Phil Blundell  <pb@reciva.com>

	* week_view.c (week_view): Attach handler to size-allocate signal
	on scrolled window.  Make vertical scrollbar policy ALWAYS.
	(week_view_update): Make minimum size for each cell be 1/7 of the
	available window height.

2006-02-06  Phil Blundell  <pb@reciva.com>

	* Version 0.71 released.

2006-02-06  Phil Blundell  <pb@reciva.com>

	* globals.h (is_reminder): New macro.
	* day_render.c (events_overlap): Use it.
	(event_rect_new): Likewise.
	(day_view_init): Likewise.
	(reminder_view_init): Likewise.
	
	* export-vcal.c (vcal_do_send_bluetooth): Correct data marshalling
	for D-BUS 0.60.

	* event-ui.c (edit_event): Take data from root event rather than
	clone.

2006-02-05  Phil Blundell  <pb@reciva.com>

	* day_view.c (day_view): Don't display sidebar calendar on QVGA
	screens, even in landscape orientation.
	* week_view.c (week_view): Likewise.

2006-02-05  Phil Blundell  <pb@reciva.com>

	* Version 0.70 released.

2006-02-05  Phil Blundell  <pb@reciva.com>

	* day_view.c (day_view): Don't allow reminder area to extend over
	the sidebar calendar.

	* configure.ac (DEP_MODULES): Demand libeventdb 0.19.

2006-02-04  Phil Blundell  <pb@reciva.com>

	* day_view.c (day_view_scroll): New function.
	(changed_callback): Don't call scroll_to() here.
	(day_view): Connect "changed" signal to scrollbar adjustment.
	(sink_scroller): New function.
	* day_view.h (day_view_scroll): New prototype.
	* main.c (set_time_and_day_view): Call day_view_scroll.
	(set_today): Likewise.
	(main): Likewise.

	* event-ui.c (struct edit_state): New members end_date_floating,
	end_time_floating.
	(new_event): Set them to TRUE.
	(sink_end_date, sink_end_time, note_time_change): New functions.
	(note_date_change_appt): Set end date here if it was floating.
	(check_constrains): Deleted.
	(set_notebook_page): Remove call to above function.
	(build_edit_event_window): Use GpeTimeSel rather than combo box
	for time selection.  All uses of these widgets updated.
	(new_event): Mark end time and date as floating.
	(edit_event): Always initialize reminder fields.
	(click_ok): Enforce minimum appointment length of one second.

	* globals.h (times): Deleted.
	* main.c (times): Likewise.
	(main): Remove code to build list of time strings.

2006-02-04  Phil Blundell  <pb@reciva.com>

	* configure.ac (DEP_MODULES): Require libgpewidget 0.109.

	* year_view.c (day_of_week): Move to...
	* main.c: ... here.
	* globals.h (day_of_week): Add prototype for above.
	* month_view.c (day_of_week): Delete "spare" copy of this function.

	* event-ui.c (weekly_toggled): Deleted.
	(build_edit_event_window): Use recalculate_sensitivities in place
	of above function.  Connect "clicked" handler to day-of-week
	recurrence buttons; connect "changed" handler to date selectors.
	(note_day_change, note_day_change_appt,
	note_day_change_reminder, note_day_change_task): New functions.
	(struct edit_state): Add recur_day_floating.
	(sink_weekly): New function.
	(new_event): Correctly set day-of-week recurrence buttons.  Set
	s->recur_day_floating.

2006-02-01  Phil Blundell  <pb@reciva.com>

	* event-ui.c (edit_event): Correctly initialize reminder time
	field and corresponding checkbox.
	(new_event): Likewise.
	(click_ok): Use event_db_clear_recurrence when appropriate.

2006-01-16  Phil Blundell  <pb@reciva.com>

	* Version 0.69 released.

2006-01-16  Phil Blundell  <pb@reciva.com>

	* day_view.c (day_page_draw_empty): Don't draw black rectangle
	around event bubbles.

	* week_view.c (draw_expose_event): Use logical extents, not ink
	extents, from Pango layout.
	(week_view_update): Likewise.

	* day_render.c (show_event): Remove spurious call to
	g_locale_to_utf8().  Replace fixed-size snprintf buffer with call
	to g_strdup_printf.
	(caption_show): Likewise.  Fix 256-byte memory leak.
	(caption_new): Deleted.
	(caption_with_pango_new): Remove argument pl.  Make Pango layout
	construction unconditional.  Rename to caption_new.
	(caption_delete): New function.
	(day_render_delete): Call it.

2006-01-16  Phil Blundell  <pb@reciva.com>

	* day_render.c (found_node, make_set,events_overlap, 
	find_set_in_list, find_set, union_set, find_overlapping_sets,
	show_event, ol_sets_to_rectangles, event_rect_new): Make static.
	(caption_show, caption_set_pango): Guard unused code with #if 0.

	* day_render.h (find_overlapping_sets): Delete prototype.

2006-01-16  Phil Blundell  <pb@reciva.com>

	* day_view.c (scroll_to): Remove mysterious call to
	gtk_adjustment_clamp_page to prevent extraneous redraws.

2006-01-16  Phil Blundell  <pb@reciva.com>

	* day_view.c (day_view_init): Remove unused variable white_gc.
	Unref newly created GC since day_render now takes a reference.
	(reminder_view_expose): Remove useless call to g_slist_length.
	Return without doing anything if rem_render==NULL.
	(reminder_view_update): Only call reminder_view_expose if list of
	events is not empty.
	(reminder_view_init): Remove unused variable white_gc.  Unref
	newly created cream_gc.  Show or hide drawing area depending on
	whether there are any events.
	(day_view_expose): Use static gray_gc rather than creating and
	destroying it on every call.

	* day_popup.c (destroy_popup): Call gtk_grab_remove.
	(button_press_event): New function.
	(day_popup): Install pointer grab on popup window.

	* day_render.c (day_render_new): Take references to GCs.
	(day_render_delete): Drop them.
	* day_view.c (day_view): Attach "send with bluetooth" button to
	send_bt_cb(), not send_ir_cb().  Correctly capitalise "Bluetooth".
	Fix typo in "Send via infra-red".
	
2006-01-15  Phil Blundell  <pb@reciva.com>

	* gtkdatesel.c (days_in_month): Deleted.  All callers adjusted to
	use version in main.c instead.
	(get_max_month_width): Use strftime_strdup_utf8_utf8.
	(format_text): Likewise.
	(get_max_day_width): Likewise.
	* event-ui.c (check_constrains): Likewise.
	(new_event): Likewise.
	(edit_event): Likewise.
	* week_view.c (draw_expose_event): Likewise.
	(week_view_update): Likewise.
	* day_popup.c (day_popup): Likewise.
	* main.c (menu_toggled): Wrap in IS_HILDON guard.
	(strftime_strdup_utf8_utf8): New function.
	(strftime_strdup_utf8_locale): Likewise.
	(main): Use strftime_strdup_utf8_locale.
	* globals.h (strftime_strdup_utf8_utf8): Add prototype.
	(strftime_strdup_utf8_utf8): Likewise.
	
	* week_view.c (week_view_button_press): Tweak formatting.

	* day_popup.c (handle_expose_event): New function.
	(handle_configure_event): Likewise.
	(day_popup): Remove GtkFrame around window contents and draw a
	simple black border instead.  Use window size from configure event
	so that positioning works correctly.  Always display "New" button,
	regardless of showing appointments or not.

2006-01-13  Florian Boor <florian.boor@kernelconcepts.de>

    * Release version 0.68.
    * event-ui.c (schedule_next), (unschedule_alarm): Silently ignore errors in
    Maemo, we don't have at here... for now.

2006-01-10  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c (create_app_menu): Make a shiny new menu according to the UI
    guidelines.
    * day_view.c: Another try to make updating faster and more efficient.
    (update_hook_callback), (day_changed_calendar): Remove explicit call of 
    update functions, this is covered by changed callback.
    (reminder_view_expose): Reorder function calls/sanity check to avoid 
    segfault. 
    (day_view_init): Update view instead of creating a new one.
    * week_view.c (week_view): Change calendar size a bit, remove separator
    in Hildon env.
    * day_render.c: Remove unused code. Some indentation fixes.
    * main.c: (create_app_menu) Extend hildon menu. (toggle_menu) New function.

2006-01-09  Florian Boor <florian.boor@kernelconcepts.de>

    * day_view.c (day_page_calc_time_width): Increase size for maemo, no idea 
    why it does not work as expected here. 
    (day_page_draw_background): Add a one pixel sized gap before time labels.
    (day_view): Don't connect "changed" signal, seems to cause duplicated 
    updates resulting in flickering and slow performance.    
    Some minor formating fixes.
    * event_ui.c (build_edit_event_window): Use a different size for maemo.

2006-01-07  Phil Blundell  <pb@reciva.com>

	* day_view.c (day_page_draw_background): Fix two memory leaks.
	Use page->time_width, not ->time_col_ratio.  Remove unnecessary
	black line on left hand side to save horizontal real estate.
	Align time strings to the left rather than centering.
	(day_page_calc_time_width): New.
	(day_page_new): Call it.  Argument "time_col_ratio" deleted.
	(day_view): Update call to day_page_new.
	* day_view.h (struct day_page): Replace time_col_ratio with
	time_width.
	* day_render.h (day_render_update_offset): Likewise.	
	* day_render.c (day_render_new): Likewise.

2006-01-07  Phil Blundell  <pb@reciva.com>

	* day_view.c (scroll_to): Manually clamp value at upper limit to
	avoid undesirable "over-scroll" effect.

2006-01-07  Phil Blundell  <pb@reciva.com>

	* day_view.c: Fix numerous missing "static" qualifiers.
	(button_press): Rename to...
	(day_view_button_press): ... this.
	* day_view.h (day_view_button_press): New prototype.
	(day_view_init): Mark extern.
	* day_render.c (day_render_new): Update reference to above function.
	(day_render_delete): Likewise.
	* day_render.h (button_press): Delete prototype.
	
2006-01-07  Phil Blundell  <pb@reciva.com>

	* day_view.c: Adjust formatting and comments.

2006-01-06  Florian Boor <florian.boor@kernelconcepts.de>

    * Release version 0.67.
    * day-view.c: Fix adjustment bounds.
    
2006-01-03  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Two more pixels.
    * event-ui.c: Tune dropdown box sizes fixing #1423.
    
2006-01-01  Phil Blundell  <pb@reciva.com>

	* configure.ac: Require libeventdb >= 0.18 and libgpevtype >=
	0.14.

2005-12-31  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Support location information in events.
    * day_view.c: Improve popup behaviour, add sanity checks and frame.

2005-12-30  Florian Boor <florian.boor@kernelconcepts.de>

    * import-vcal.*, main.c: Fix and clean up vcal/ics import.

2005-12-29  Florian Boor <florian.boor@kernelconcepts.de>

    * day_view.c: Clean up scroll code, fix memory leak.

2005-12-20  Florian Boor <florian.boor@kernelconcepts.de>
    
    * day_view.c, event-ui.c, globals.h: Apply patch to fix segfault 
      deleting events with alerts contributed by Denny Priebe.
    * day_view.c: Fix warnings when casting button to window.
    * day_render.c: Minor formating fix, fix segfault caused by broken 
                    event descriptions. Maybe not perfect but no segfaults 
                    anymore.
    * day_view.c: Proposed fix to avoid popup window getting in front of 
                  dialog windows. (#1432)

2005-12-08  Florian Boor <florian.boor@kernelconcepts.de>
    
    * day_view.c: Use defined gray instead colour from style because this 
                    depends on the theme.
    * day_render.c: Make sequenced events without break become displayed in 
                    sequence instead of overlapping.

2005-12-06  Florian Boor <florian.boor@kernelconcepts.de>

    * export-vcal.c, configure.ac: Apply patch to support new DBus API
                                   contributed by Philipp Zabel.

2005-11-29  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Use hildon dialog to ask about event starting in the past.
    * configure.ac: Add hildon-libs as a dependency for maemo config.
    * main.c: Some minor cleanup and event mask change.
    * event-ui.c: Force modal dialog on all platforms works around a 
                  matchbox issue and is better anyway.

2005-11-23  Florian Boor <florian.boor@kernelconcepts.de>

    * Release version 0.66.
    * familiar/control1: Update dependencies to up to date libgpevtype.

2005-11-22  Florian Boor <florian.boor@kernelconcepts.de>

    * configure.ac: Push version number...
    * month_view.c: Add some #ifdefs because sizing is a little bit different
                    in the Hildon environment.
    * export-vcal.c: Remove unused line breaking build.
    * day-view.c, day-render.c: Make gap selectable again to have a reminder 
                                area without gap. Some more minor changes.

2005-11-21  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c: Add category editing button and menu item.
    * week_view.c, month_view.c, main.c: Several improvements and fixes in 
                                         display code. Improve hildon menu.

2005-11-10  Florian Boor <florian.boor@kernelconcepts.de>

    * day_view.c: Hide unavailable export buttons.
                  Hide popup before opening selector.
    * export-vcal.c: Make Hildon UI compatible.
	* event_ui.c: Use buttonbox for Hildon UI makes buttonl look much better.
	* day_view.c: Fix widget creation.
	* main.c: Fix missing toolbar.
    * dav_view.c: Clean up context popup, check if export mechanisms are 
                  available.
    * main.c: Proposed fix for visible, useless selectors.

2005-11-07  Florian Boor <florian.boor@kernelconcepts.de>

    * export-vcal.*: New files implementing event data export. Derived from
                     gpe-contacts.
    * configure.ac: Add parameter to switch DBus usage like in gpe-contacts.
    * main.c: Initialize export stuff.
    * day_view.c: Start to implement improved popup supporting data export.
    * event.h: Obviously unused -> removed.

2005-11-05  Florian Boor <florian.boor@kernelconcepts.de>

	* event-ui.c: Change some widget packing to clean up UI.
	              Move categories and text to new "detail" tab to free screen 
				  space for the keyboard.
				  Remove shadows from viewports for a cleaner look.
				  Remove some extra padding from button box.

2005-10-28 Luca De Cicco <ldecicco@gmail.com>
	* day_view.c: Day view automatically scrolls to current hour if
	possible

2005-10-25  Florian Boor <florian.boor@kernelconcepts.de>

	* gtkdatesel.c: Move week selector to the left.
    * month_view.c: Reduce size of event summary text.
    * day_view.c: Reduce width of time area on wide screens.
	* debian: Add maemo debian packaging stuff.
	* month_view.c: Make title a little bit higher.

2005-10-23  Florian Boor <florian.boor@kernelconcepts.de>

	* day_render.c, day_view.c: Fixed some runtime warnings, some reformating.
	* gtkdatesel.c: Avoid moving positions selecting a new day.
	* gtkdatesel.c: Add header to avoid warning. Change forward/backward buttons
	                in Hildon UI.
	* month_view.c: Fix title height in Hildon UI.

2005-10-21  Florian Boor <florian.boor@kernelconcepts.de>

	* main.c: Fix service name, Hildon UI bits.
	* Makefile.am: Add maemo package files to EXTRA_DIST.
	* day-view.c, event-ui.c: Some more Hildon UI bits and reformating.
	* gtkdatesel.c: Minor Hildon UI compatibility fix.

2005-10-20  Florian Boor <florian.boor@kernelconcepts.de>

	* hildon/*.in, Makefile.am, configure.ac: Change dbus service name.
	* main.c: Use Hildon file selection dialog in Hildon UI.

2005-10-19  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c: Apply patch to support fullscreen mode in Maemo environment.
              A contribution by Devesh Kothari and Philippe De Swert.

2005-10-13  Florian Boor <florian.boor@kernelconcepts.de>

    * globals.h, main.c: Adapt icon loading to nasty Maemo environment.
    * day_render.c: Add sanity check.

2005-10-11  Luca De Cicco <ldecicco@gmail.com>
	* day_render.c, day_render.h: New files. They implement the day render
	`class` to display events as boxes avoiding overlapping.
	* day_view.c, day_view.h: Using day_render to display events instead
	of obsolete clist 


2005-10-10  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Fix categories handling and restoring. (#1402)

2005-09-27  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Improve window type selection to behave better using Matchbox.

2005-09-09  Luca De Cicco <ldecicco@gmail.com>
	* month_view.c: Adding support for scrolled window.

2005-08-31  Florian Boor <florian.boor@kernelconcepts.de>

	* Release version 0.65
    * import-vcal.c: Fix warning.
    * po/POTFILES.in: Removed some files.
    
2005-08-30  Florian Boor <florian.boor@kernelconcepts.de>

    * import-vcal.c: Convert to new libmimedir API.

2005-08-30  Philippe De Swert <philippedeswert@scarlet.be>

	* release version 0.64 as the previous fix by Florian is quite important

2005-08-29  Florian Boor <florian.boor@kernelconcepts.de>

	* main.c: Rewrite toolbar to use new API. Fix warning.
	* Move *.desktop.in to *.desktop.in.in to fix creating of translated
	  desktop files.
	* configure.ac:  Create *.desktop.in instead of *.desktop.
	* po/Makefile.in.in: Update.

2005-08-24  Philippe De Swert <philippedeswert@scarlet.be>

	* release version 0.63

2005-08-24  Joseph J. McCarthy <mccarthy@engrng.pitt.edu>

	* day_view.c: use new libschedule API (and change to internal schedule
	calls)
	* event-ui.c: use new libschedule API; change internal schedule calls 
	so that an errorbox can be used to warn if there are at problems
	* event-ui.h: changes to internal schedule stuff
	* main.c: use new libschedule API (and change to internal schedule 
	calls)		 

2005-08-16  Matthias Steinbauer <matthias@steinbauer.org>

        * main.c: Included basic LibOSSO Support.

2005-08-08  Matthias Steinbauer <matthias@steinbauer.org>

	* main.c: Added basic hildon support adjusted main-window to appview
	  put toolbar to the bottom.
	* event-ui.c: click_categories adjusted to fit to the hildon extensions
	  in libgpewidget.

2005-07-27  Florian Boor <florian.boor@kernelconcepts.de>

	* main.c: Remove explicit use of obsolete libdisplaymigration.
	* po/POTFILES.in, autogen.sh, configure.ac, *.am: Add autotools support
	  including hildon UI framework integration support.
	* Move gpe-calendar.png to pixmaps subdir.
	* .cvsrc: Ignore a pile of autogenerated files.
	* hildon/*: Add some files for hildon UI support.

2005-03-20  Florian Boor <florian.boor@kernelconcepts.de>
	
	* Version 0.62 released.

2005-03-14  Florian Boor <florian.boor@kernelconcepts.de>

	* Removed obsolete inclusion of render.h

2005-01-16  Phil Blundell  <philb@gnu.org>

	* Version 0.61 released.

2005-01-16  Phil Blundell  <philb@gnu.org>

	* gtkdatesel.c (get_max_month_width): New function.
	(gtk_date_sel_set_month_style): Use it.
	(get_max_day_width): New function.
	(gtk_date_sel_init): Use it.

2005-01-09  Phil Blundell  <philb@gnu.org>

	* Version 0.60 released.

2005-01-09  Phil Blundell  <philb@gnu.org>

	Apply patches from Peter Naulls:
	* week_view.c (draw_expose_event): Use different background colours
	for weekdays, weekends, and days with events.
	* month_view.c (draw_expose_event): Likewise.	

2005-01-09  Phil Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Avoid GtkButtonBox.  Allow
	start and end time fields to expand horizontally.

	* Makefile (LIBGPEVTYPE_PC_EXTRA): Prepend to PKG_CONFIG_PATH,
	don't replace it.

2004-12-21  Florian Boor <florian.boor@kernelconcepts.de>
	
	* Version 0.59 released.

2004-11-25  Florian Boor <florian.boor@kernelconcepts.de>

	* event-ui.c: Applied patch to fix transientness, thanks to
          Christian Gillot for this patch.

2004-11-15  Phil Blundell  <pb@nexus.co.uk>

	* week_view.c (week_view_button_press): Bring popup behaviour in
	line with month view: single left click moves focus; double left
	click moves focus and switches to day view; right click opens
	popup menu.

2004-11-15  Phil Blundell  <pb@nexus.co.uk>

	* month_view.c (button_press): Delete bogus check for button==1.

	* week_view.c (week_view_key_press_event): Replace complicated
	up/down logic with calls to gtk_date_sel_move_day.

2004-11-07  Phil Blundell  <pb@nexus.co.uk>

	* Makefile (LINGUAS): Add zh_CN.
	* po/zh_CN.po: New file, courtesy Meng Jie.

2004-10-09  Phil Blundell  <pb@nexus.co.uk>

	* Version 0.58 released.

2004-10-09  Phil Blundell  <pb@nexus.co.uk>

	* day_view.c (day_changed_calendar): Do nothing if date has not
	actually changed.
	* week_view.c (day_changed_calendar): Likewise.

2004-10-09  Phil Blundell  <pb@nexus.co.uk>

	* day_view.c (day_view): Single click on calendar moves highlight,
	even when not in stylus mode.
	* week_view.c (week_view): Likewise.

2004-10-09  Phil Blundell  <pb@nexus.co.uk>

	* month_view.c (title_height): New global.
	(button_press): Use it.
	(draw_expose_event): Likewise.  Avoid wasteful re-initialisation
	of static data on every call.  Draw day number in top-left corner
	of cell.
	(calc_title_height): New function.
	(month_view): Call it.

	* gtkdatesel.h (gtk_date_sel_move_day): Really add prototype.

	* week_view.c (struct week_day): Delete 'initialized'.
	(week_view, week_view_update): Remove references to above member.
	(day_changed_calendar): New function.
	(changed_callback): Rename to ...
	(day_changed_datesel): ... this.  Keep calendar up to date.
	(update_hook_callback): Keep calendar up to date.  No need to call
	gtk_widget_draw on datesel.
	(week_view_key_press_event): Fix warnings.  Keep calendar up to
	date.

	* main.c (time_from_day): Don't force time to 00:00.

	* day_view.c (day_view): Add calendar if screen is landscape.
	(list_exposed): Fix warning.
	(update_hook_callback): Keep calendar up to date.  No need to call
	gtk_widget_draw on datesel.
	(changed_callback): Rename to ...
	(date_sel_changed): ... this.  Keep calendar up to date.
	(day_changed_calendar): New function.

	* gtkdatesel.c (gtk_date_sel_set_month_style): Calculate maximum
	width of month string.
	(gtk_date_sel_init): Likewise for year.
	(make_field): Rework widget packing to prevent arrows from moving
	around.
	(struct elem): Add container.  Remove arrow_l and arrow_r.

2004-10-07  Phil Blundell  <pb@nexus.co.uk>

	* Version 0.57 released.

2004-10-07  Phil Blundell  <pb@nexus.co.uk>

	* future_view.c, future_view.h: Deleted.
	* Makefile (MEMBERS): Remove future_view.
	* main.c: Delete references to future_view.	

2004-10-07  Phil Blundell  <pb@nexus.co.uk>

	* day_view.c (list_key_press_event): Use left/right keys to move
	between days.
	
	* week_view.c (week_view_key_press_event): Replace big list of
	"if" statements with switch.  Use left/right keys to move between
	weeks.
	(draw_expose_event): Draw cursor in blue, not red, to reassure
	users that nothing is wrong.  Remove ugly grey bar on left of
	screen.  Add "wide mode" with date labels on left and first event
	on same line as label.	

	* month_view.c (draw_expose_event): Draw cursor in blue, not red.
	(button_press): Make button-1 clicks move the highlight, and
	button-3 clicks pop up the menu.
	(month_view_update): Provide forward decl.  Simplify handling of
	active_day a bit.

	* gtkdatesel.c (gtk_date_sel_move_day): New function.
	(gtk_date_sel_move_week): Likewise.
	(gtk_date_sel_move_month): Likewise.
	(day_click, week_click, month_click): Implement in terms of above.
	* gtkdatesel.h (gtk_date_sel_move_day, gtk_date_sel_move_week,
	gtk_date_sel_move_month): New prototypes.

2004-10-06 Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Added warning if event starts in the past.

2004-09-20 Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Fixed event lossage if returning from reminder to appointment. 
    * month_view.c, week_fiew.c: Allow focus to fix keyboard control.
    * main.c: Fixed typo and not necessary updates.
    * main.c: Changed today_button to become a real togglebutton.
    * event-ui.c: Window modal to avoid open it more than once.

2004-09-03 Florian Boor <florian.boor@kernelconcepts.de>

    * Released V 0.56
    * main.c: Fixed tooltips, changed button label.
    * main.c: Added some hotkeys for common operations.
    * main.c: Some GUI tuning.
    * gtkdatesel.c: Increasing the arrow button sizes a little bit.

2004-09-01  Florian Boor <florian.boor@kernelconcepts.de>

	* main.c, event-ui.c: Make sure the correct widget has focus if we start 
	                      a new event.

2004-08-30  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c, event-ui.c: Buffer characters to add in a new event.

2004-08-29  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c: Don't add spaces if screen width < 260 pixels.

2004-08-24  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Select current day of week as default for weekly recurrence.

2004-08-18  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c: Prevent user from accidentally creating more than on new event.
    * Released V 0.55
    * day_view.c, week_view.c, month_view.c: Removed focus changes on 
      direction key press.

2004-08-10  Florian Boor <florian.boor@kernelconcepts.de>

    * main.c: Typing opens "new event" dialog now.

2004-08-08  Florian Boor <florian.boor@kernelconcepts.de>

	* main.c: Implemented vcard import via command line switch "-i <file>"

2004-08-05  Florian Boor <florian.boor@kernelconcepts.de>

    * event-ui.c: Fixed titles, layout and positions of recurrence tab.

2004-07-23  Florian Boor <florian.boor@kernelconcepts.de>
    
    * Released V 0.54
    * added several translations to cvs
    * event_ui.c: Changes in keyboard control to use direction keys to navigate.
    * main.c: Improved handling of updates and some feedback if the "today" 
              button is active.
    * future_view.c: Added updating of date label.
    * *view.c: Some updates to day selection stuff.
    * globals.h, main.c: Added some global routines.

2004-07-22  Florian Boor <florian.boor@kernelconcepts.de>
    
    * month_view.c: Change: "today" in update routine is set to "viewtime" now.
    * *view.c, main.c: Several hacks to keep active day global and up to date.
    * event_ui.c: Multiple optical uodates and small fixes.
                  Set default focus to text field, set some window parameters.
    * main.c: Added function to set current date.
    * *view.c: Honor global setting to today.

2004-07-21  Florian Boor <florian.boor@kernelconcepts.de>

    * Makefile: Working on V 0.54 now.
    * main.c: Make default window size a little bit cleverer.
    * year_view.*, month_view.*, week_view.*, future_view.*:
      Added function to free allocated lists from eventdb.
    * event-ui.c: Added handling of escape and enter keys to abort/save.
    * import-vcal.c: import_vcal(): Returns success now. 
                     Removed obsolete dialog.
    * main.c: Import status dialog, error detection.

2004-07-20  Florian Boor <florian.boor@kernelconcepts.de>

    * import-vcal.h: New file.
    * import-vcal.c: New files taken from gpe-bluetooth by Philip Blundell.
    * main.c, Makefile: Started to add VCAL import facility.
    * month_view.c: Improved year handling.
    * month_view.c: Improved keyboard controls.    

2004-07-19  Florian Boor <florian.boor@kernelconcepts.de>

    * month_view.c: Started simple keyboard control.
    * day_view.c: Keyboard control improvements, still not perfect.
    * week_view.c, day_popup.c: Improved UI, event creation for wek view,
                                fixed some bugs in time handling. 
    * day_popup.*: Keyboard control update, parameter wether to show items 
                   or not.

2004-07-16  Florian Boor <florian.boor@kernelconcepts.de>
    
    * day_popup.c: Started some keyboard controls.
    * week_view.c: More keyboard controls and basic popups.
    * week_view.c: Very basic keyboard controls for week view.
    * week_view.c: Formating updates, minor painting improvements.
    
2004-07-15  Florian Boor <florian.boor@kernelconcepts.de>

    * day_view.c: selection_made() Changed clicking behaviour to start edit
                  on click on any entry.
    * day_view.c: Started implementing keyboard control, deleting of events.
    * main.c: Removed hardcoded toolbar style.
    * day_view.c: Don't display very early/late slots if they are not used.
    * day_view.c, event_ui.c: Some formating improvements.
    * event_ui.c: click_delete() Replaced obsolete gpe_question_ask_yn().
    * week_view.c: Activate scrollbar only if necessary.

2004-06-21  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add es, sk, sr, ru, hu.

2004-06-01  Philip Blundell  <philb@gnu.org>

	* Version 0.53 released.

2004-05-28  Phil Blundell  <pb@nexus.co.uk>

	* gtkdatesel.c (struct _GtkDateSel): Add subbox.
	(make_field): Put widgets into subbox, not top-level box.  Set
	expand and fill to FALSE when packing.
	(gtk_date_sel_init): Create subbox and pack it into top level.

2004-03-25  Philip Blundell  <philb@gnu.org>

	* Version 0.52 released.

2004-03-08  Philip Blundell  <philb@gnu.org>

	* Makefile (PACKAGE_LDFLAGS, PACKAGE_CFLAGS, PACKAGE_CPPFLAGS):
	Define and use instead of LDFLAGS, CFLAGS and CPPFLAGS.

2004-03-06  Philip Blundell  <philb@gnu.org>

	* Version 0.51 released

2004-03-05  Philip Blundell  <philb@gnu.org>

	* event-ui.c: Include pim-categories-ui.h to fix warning.
	(edit_event): Exercise caution around details struct since
	pointers may be NULL.
	(click_delete): Remove useless call to gtk_widget_get_toplevel.

2004-02-23  Joseph J. McCarthy <mccarthy@engrng.pitt.edu>
                                                                                
        * Version 0.50 released.
                                                                                
2004-02-22  Phil Blundell  <pb@nexus.co.uk>

	* Makefile (CPPFLAGS, LDFLAGS): Add libgpepimc.
	* main.c (main): Call gpe_pim_categories_init().
	* event-ui.c (struct edit_state): Add categories,
	categories_label.
	(destroy_user_data): Handle categories.
	(click_ok): Stash new categories.
	(build_categories_string): New.
	(update_categories): Likewise.
	(click_categories): Likewise.
	(build_edit_event_window): Add categories handling.	

2004-02-20  Joseph J. McCarthy <mccarthy@engrng.pitt.edu>
                                                                                
        * event-ui.c : update last_modified when changes are made 
                                                                                
2004-02-14  Philip Blundell  <philb@gnu.org>

	* Version 0.49 released.

2004-02-09  Phil Blundell  <pb@nexus.co.uk>

	* README: Delete useless empty file.
	* TODO: Delete useless outdated file.
	
	* event-ui.c (build_edit_event_window): Set default size on new
	window.

	* future_view.c (future_view): Set NEVER policy for horizontal
	scrollbar.

2004-02-08  Howell Tam	<pigeon@pigeond.net>
	
	* event-ui.c: Recurring page now shows corresponding fields properly.
	* day_popup.c: Likewise.
	* day_view.c: Likewise.
	* future_view.c: Likewise.
	* main.c: Likewise.
	* event-ui.c: Recurrence page now in a scrolled window.

2003-10-19  Philip Blundell  <philb@gnu.org>

	* Makefile: Don't link with -lsqlite.  Use STANDARD_CFLAGS,
	STANDARD_CPPFLAGS, STANDARD_LDFLAGS.

2003-10-18  Philip Blundell  <philb@gnu.org>

	* Makefile (CPPFLAGS): Undo last change.

2003-10-09  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add cs.

2003-09-24  Philip Blundell  <philb@gnu.org>

	* Makefile: Use $(GPECFLAGS), $(GPELIBS).
	(CPPFLAGS): Add -DG_DISABLE_CAST_CHECKS.

2003-09-23  Philip Blundell  <philb@gnu.org>

	* gpe-calendar 0.48 released.

2003-09-23  Philip Blundell  <philb@gnu.org>

	* gpe-calendar.session: Add missing #!/bin/sh.

2003-09-07  Philip Blundell  <philb@gnu.org>

	* Version 0.47 released.
	
2003-09-07  Philip Blundell  <philb@gnu.org>

	* gtkdatesel.c (format_text): Fix cut and paste error in last
	change.

2003-09-06  Philip Blundell  <philb@gnu.org>

	* Version 0.46 released.
	
2003-09-06  Philip Blundell  <philb@gnu.org>

	* gtkdatesel.c (format_text): Convert format string back to native
	locale encoding before calling strftime.

  	Patch from Libor Klepac:
	* day_popup.c (day_popup): Recode result of strftime to UTF-8.
	* event-ui.c (build_edit_event_window): Likewise for nl_langinfo
	strings.

	* po/nl.po: New file, courtesy Elros Cyriatan.
	* Makefile (LINGUAS): Add nl.

2003-09-05  Philip Blundell  <philb@gnu.org>

	* familiar/control1 (Source): Added.

2003-09-05  Philip Blundell  <philb@gnu.org>

	* Version 0.45 released.

2003-09-05  Philip Blundell  <philb@gnu.org>

	* day_view.c (selection_made): Avoid infinite loops and crashes
	with untimed events.

2003-07-29  Philip Blundell  <philb@gnu.org>

	* gtkdatesel.c (format_text): Convert strftime() output to UTF-8.
	* week_view.c (week_view_update): Likewise.	
	* future_view.c (future_view_update): Likewise.
	(future_view): Likewise.

2003-07-13  Phil Blundell  <pb@nexus.co.uk>

	* Makefile (CFLAGS): Use libdisplaymigration in place of libdm.
	(LDFLAGS): Likewise.

2003-07-08  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>
	
	* Makefile: released version 0.44
	
2003-07-08  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>
	
	* day_view.c (selction_made): added a search for dat when multiple
	events are liste3d in the same timeslot (stops the crash)
	
2003-07-08  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>
	
	* main.c : add new global week_offset to allow week_starts_monday to
	affect month-view
	* month_view.c (draw_expose_event): Move days declaration and setting
	as well as add several week_offset changes so that week_starts_monday
	works in month-view
	* xsettings (notify_func): change week_offset along with
	week_starts_monday
	* globals.h : add week_offset
	
2003-07-06  Moray Allan  <moray@sermisy.org>

	* day_view.c (day_view_update), future_view (future_view_update),
	Makefile: Removed legacy GTK1 code.

2003-07-06  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add sv.
	* po/sv.po: New file, courtesy Christian Rose.	

2003-06-22  Philip Blundell  <philb@gnu.org>

	* main.c (main): Hook delete-event signal, not destroy.

2003-07-06  Moray Allan  <moray@sermisy.org>

	* Makefile (install_program), gpe-calendar.menu: No longer install
	old-style menu file.

2003-06-26  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add wa.
	(install-program): Preserve extension on installed .desktop file.
	* po/wa.po: New file, courtesy Pablo Saratxaga.

2003-05-09  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add ro.
	* po/ro.po: New file, courtesy Laurentiu Buzdugan.

2003-04-27  Philip Blundell  <philb@gnu.org>

	* event-ui.c (edit_event): Set event-type notebook to appropriate
	page.
	(new_event): Likewise.  Set option-menu as well.

2003-04-25  Philip Blundell  <philb@gnu.org>

	* Version 0.43 released.

2003-04-25  Philip Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Increase range of alarm spinner.
	(click_ok): Use an array rather than a switch to decode alarm multipliers.
	(new_event): Set the date for reminders.
	(edit_event): Likewise.  Set units appropriately for alarm time.

	* old-db.c: Deleted.

2003-04-21  Philip Blundell  <philb@gnu.org>

	* Version 0.42 released.
	
2003-04-21  Philip Blundell  <philb@gnu.org>

	* day_view.c (day_view_update): Remove spurious call to
	gtk_clist_set_row_data.  Reorganise code slightly for improved
	clarity.

	* main.c (main): Ensure day-view button is selected.

2003-04-20  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add zh_TW.
	* po/zh_TW.po: New file, courtesy Chao-Hsiung Liao.

2003-04-12  Christian Meyer  <chrisime@gnome.org>

	* event-ui.c (build_edit_event_window): Moved some code to proper
	places. It's easier to read now. Ongoing work...

2003-04-11  Philip Blundell  <philb@gnu.org>

	* Version 0.41 released.
	
2003-04-11  Philip Blundell  <philb@gnu.org>

	* familiar/control1 (Depends): Require libeventdb 0.06.

	* event-ui.c (click_delete): Reformat.  Make question string
	static and mark for translation.  Fix warning about argument
	shadowed by local var.
	(unschedule_alarm): Reformat.
	(schedule_next): Likewise.  Use g_strdup_printf to avoid buffer
	overrun.
	(click_ok): Reformat.
	(edit_event): Likewise.

2003-04-11  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>
	
	* day_view.c (day_view_update): move GSList declares of day_events and
	untimed_events to outside function, also delete old GSLists (and
	clones) directly prior to building new ones
	* event-ui.c (click_delete): switch to taking window as arg (instead
	of event_t), switch to checking existence of ev->recur (rather than
	checking flags), add a forget_details, minor things (set RECUR flag in
	click_ok, toggle the none button in event_edit, move s->ev=ev to end)
	* future_view.c : move GSList declares outside function
	* month_view.c : likewise
	
2003-04-11  Christian Meyer  <chrisime@gnome.org>

	* gtkdatesel.{cc,h}: GObject'ification. :-)
	
2003-04-10  Philip Blundell  <philb@gnu.org>

	* familiar/control: Deleted.

	* week_view.c (draw_expose_event): Remove spurious
	g_locale_to_utf8.
	(week_view_update): Likewise.

2003-04-08  Philip Blundell  <philb@gnu.org>

	* po/de.po: Updated, courtesy Colin Marquardt.

2003-04-07  Philip Blundell  <philb@gnu.org>

	* po/fr.po: New file from Translation Project, courtesy Luc Pionchon.
	* Makefile (LINGUAS): Add fr.

	* po/pt.po: Updated, courtesy Luis Oliveira.
	* po/pt_PT.po: Deleted.

2003-04-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* future_view.c: delete old clone-checking cruft
	* event-ui.c: stop double freeing clones and move recurrence
	checking/getting
	* day_view.c: stop using FLAG_RECUR
	* day_popup.c: likewise
	
2003-04-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* event-ui.c: use libschedule
	* familiar/control*: likewise
	
2003-04-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* week_view.c: fix declaration locations so it builds on ipaq cluster
	* event-ui.c: likewise
	* month_view.c: likewise
	
2003-04-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* main.c: change set_day_view to set_time_and_day_view and change
	original call to be new_view(day) so set_day_view becomes unnecessary
	* event-ui.c: get rid of find_by_uid since I have added a pointer in
	event_t that points to the original ev (for a clone). fix small memory
	leak in schedule_next, ALLOW EXCEPTIONS to recurring events (so delete
	needs to ask about what you are deleting...maybe someday I will allow
	editting of a single instance, but this will likely be done by
	deleteing one (like this code now does) and making a completely new
	event), also fix the alarm spinner code so it always reports ev->alarm
	in seconds...I cannot seem to get the show/hide of the recurring page
	worked out when editting stuff! 
	* day_view.c : erase check for clones since I use *all* clones now and
	get rid of calls to find_by_uid
	* future_view: erase reference to gtkdatesel and delete calls to
	find_by_uid
	* month_view: use set_time_and_day_view now
	* globals.h: use set_time_and_day_view now
	* day_popup: use set_time_and_day_view now and eliminate find_by_uid

2003-03-30  Philip Blundell  <philb@gnu.org>

	* gtkdatesel.c: New file.
	* gtkdatesel.h: Likewise.
	* Makefile (MEMBERS): Add gtkdatesel.
	* day_view.c: Adjust path to gtkdatesel.h.
	* week_view.c: Likewise.
	* month_view.c: Likewise.
	* year_view.c: Likewise.

2003-03-29  Luis Oliveira  <luis@handhelds.org>

	* event-ui.c (edit_event): Set type menu to Appointment/Reminder.
	(set_notebook_page): Use gtk_option_menu_get_history() instead of
	gtk_simple_menu_get_result().
	(build_edit_event_window): Connect "changed" signal to the type
	GtkSimpleMenu instead of "item-changed".

2003-03-29  Philip Blundell  <philb@gnu.org>

	* week_view.c (draw_expose_event): Rearrange decls for pre-C99
	compilers.

	* Makefile (clean): Also remove .desktop file.

	* event-ui.c (build_edit_event_window): Use tables in recurrence
	tab.

	* Makefile (install-program): Use install -s.

2003-03-28  Philip Blundell  <philb@gnu.org>

	* Version 0.40 released.

2003-03-27  Philip Blundell  <philb@gnu.org>

	* event-ui.c (click_ok): Fix formatting.
	(build_edit_event_window): Remove unused widgets.  Remove spurious
	border width on internal boxes; just put it on the top level in
	each tab.  Correct packing of widgets in reminder table.

2003-03-23  Phil Blundell  <pb@nexus.co.uk>

	* Version 0.39 released.

2003-03-23  Phil Blundell  <pb@nexus.co.uk>

	* main.c (main): Rearrange order of packing to get toolbar icon
	sizes right.

2003-03-23  Phil Blundell  <pb@nexus.co.uk>

	* Version 0.38 released.

2003-03-23  Phil Blundell  <pb@nexus.co.uk>

	* event-ui.c (build_edit_event_window): Tweak expand and fill
	arguments for better effect.  Include <gpe/spacing.h>.

2003-03-23  Christian Meyer  <chrisime@gnome.org>
                                                                        
	* event-ui.c (build_edit_event_window): Improved layout quite a
	bit. Removed unnecessary code, deprecated function calls.

2003-03-23  Phil Blundell  <pb@nexus.co.uk>

	* Version 0.37 released.

2003-03-23  Phil Blundell  <pb@nexus.co.uk>

	* globals.h (VERSION): Delete.
	(update_all_views): Add prototype.

	* event-ui.c (click_elete): Call update_all_views not
	update_current_view.
	(click_ok): Likewise.

	* main.c (update_view): New function.
	(update_current_view): Use it.
	(update_all_views): New function.
	(init_views): Deleted.
	(main): Use update_all_views.
	(set_day_view): Remove update_current_view call.

2003-03-22  Phil Blundell  <pb@nexus.co.uk>

	* Version 0.36 released.

2003-03-22  Phil Blundell  <pb@nexus.co.uk>

	* event-ui.c (build_edit_event_window): Don't use GtkDialog.

	* Makefile (LDFLAGS): Add -rpath-link for libxsettings.

2003-03-19  Philip Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Use GtkDialog.
	(recalculate_sensitivities): Fix typo.

	* main.c (main): Use gtk_window_set_default_size not
	gtk_widget_set_usize.

2003-03-19  Christian Meyer  <chrisime@gnome.org>

        * event-ui.c: Indentation fixes.
	
2003-03-19  Christian Meyer  <chrisime@gnome.org>

        * event-ui.c: Remove GTK 1 compatibility.

2003-03-19  Philip Blundell  <philb@gnu.org>

	* week_view.c (draw_expose_event): Remove GTK1 compatibility.
	Recode strings obtained from nl_langinfo into UTF8 for display.
	* month_view.c (draw_expose_event): Likewise.
	Patch from Christian Meyer <chrisime@gnome-de.org>.
	
	* event-ui.c (build_edit_event_window): Remove frame around
	description.  Put start/end dates and times in a table.  Patch
	from Christian Meyer <chrisime@gnome-de.org>.

2003-03-19  Philip Blundell  <philb@gnu.org>

	* xsettings.c (notify_func): Add missing const. Patch from
	Christian Meyer <chrisime@gnome-de.org>.

	* main.c (gpe_cal_exit): Fix formatting.
	(main): Likewise.  Remove GTK 1 compatibility code.  Scale toolbar
	icons to desired size.  Use stock item for new and exit buttons.

2003-03-19  Philip Blundell  <philb@gnu.org>

	* Makefile (LINGUAS): Add pt, de.

	* po/pt.po: New file from Translation Project, courtesy Luis
	Oliveira.

	* event-ui.c: Replace GtkObject with GObject.  Patch from
	Christian Meyer <chrisime@gnome-de.org>.
	* day_popup.c: Likewise.
	* day_view.c: Likewise.
	* week_view.c: Likewise.
	* month_view.c: Likewise.
	* year_view.c: Likewise.
	* future_view.c: Likewise.
	* main.c: Likewise.
	(main): Call bind_textdomain_codeset.
	
2003-03-08  Philip Blundell  <philb@gnu.org>

	* familiar/control1 (Depends): Remove libsqlite0.  Add 
	gpe-calendar-locale*.

	* Makefile (LINGUAS): Add id.
	* po/id.po: New file from Translation Project.

2003-03-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* version 0.35

2003-03-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* main.c: add an update_current_view to set_day_view
	* event-ui.c: finally alarm things (disallow changing away from
	"minutes before" for now, add user id to alarmname, dont
	subtract minutes before twice) 
	* day_view.c : change widget_show to widget_show_all so new
	event-edit windows get displayed properly

2003-02-17  Philip Blundell  <philb@gnu.org>

	* main.c (main): Mark window title for translation.  Reformat
	option parsing code.

	* event-ui.c (build_edit_event_window): Replace trailing "(s)"
	with "s" for ease of translation.

	* Makefile (install): Depend on $(PACKAGE).desktop.

	* gpe-calendar.desktop.in: New file.
	* gpe-calendar.desktop: Deleted.

2003-02-13  Philip Blundell  <philb@gnu.org>

	* Version 0.34 released.

2003-02-13  Philip Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Just say "Start" and "End"
	not "Start on" and "End on".  Put recurrence widgets inside a
	notebook.  Remove setting of window default size.

2003-02-12  Philip Blundell  <philb@gnu.org>

	* Makefile (install): Don't install obsolete pixmaps.
	* pixmaps/close.xpm, pixmaps/config.xpm, pixmaps/dayview.xpm,
	pixmaps/exit.xpm, pixmaps/futureview.xpm, pixmaps/monthview.xpm,
	pixmaps/new.xpm, pixmaps/save.xpm, pixmaps/today.xpm,
	pixmaps/weekview.xpm, pixmaps/yearview.xpm: Delete.

2003-01-19  Philip Blundell  <philb@gnu.org>

	* event-ui.c (edit_finished): Re-enable window cache.
	(gtk_box_pack_start_show): Delete.
	(build_edit_event_window): Remove calls to gtk_widget_show.

	* future_view.c (selection_made): Use gtk_widget_show_all with
	event window.
	* day_view.c (selection_made): Likewise.	
	* day_popup.c (selection_made): Likewise.
	* main.c (new_appointment): Likewise.

2003-01-19  Philip Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Don't realize window
	explicitly.  Install "destroy" handler on new window.  Connect
	cancel button to edit_finished directly.
	(click_delete): Reformat.
	(click_ok): Likewise.
	(schedule_next): Likewise.
	(edit_finished): Return TRUE as gboolean.
	(click_cancel): Delete.

2003-01-18  Philip Blundell  <philb@gnu.org>

	* Version 0.33 released.

2003-01-18  Philip Blundell  <philb@gnu.org>

	* familiar/control1 (Depends): Require libdm0, libeventdb 0.02.

	* main.c (main): Use stock icons.
	* day_popup.c (day_popup): Likewise.
	* event-ui.c (build_edit_event_window): Likewise.

	* main.c (my_icons): Remove now-redundant entries.

2003-01-13  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* main.c: change update_current_view to happen at
	startup and then only when things change (rather than
	with every view switch), small fixes for rescheduling
	* event-ui.c: finally fix rescheduling of events, and
	turn off the caching of event windows (for now)
	* event-ui.h: remove event_ui_init prototype
	* gpe-calendar.session: same
	* day_popup.c : revert to old row bindings with check
	for clones
	* future_view.c : revert to old row bindings with check
	for clones
	* day_view.c : revert to old row bindings with check
	for clones
	
2003-01-08  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* main.c: add "skip" time
	* event-ui.c: same
	* event-ui.h: same
	* gpe-calendar.session: same
	* day_popup.c : add pretty pixmaps
	* day_view.c : cut space down
	
2003-01-08  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* Makefile: removed reference to old-db.c
	
2003-01-08  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* main.c: Change "event-db.h" for <gpe/event-db.h>
	* event-ui.c: fix notebook page handling on edit/new
	
2003-01-06  Philip Blundell  <philb@gnu.org>

	* event-db.c, event-db.h: Deleted; moved to ../libeventdb.

2003-01-06  Luis Oliveira  <luis@handhelds.org>

	* Makefile (MEMBERS): remove event-db and old-db.
	(CPPFLAGS): add -I../libeventdb.
	Linking against libeventdb.
	* day_popup.c: Change "event-db.h" for <gpe/event-db.h>
	* day_view.c: Likewise.
	* event-ui.c: Likewise.
	* event-ui.h: Likewise.
	* globals.h: Likewise.
	* month_view.c: Likewise.
	* week_view.c: Likewise.
	* year_view.c: Likewise.
	* familiar/control1 (Depends): Add libeventdb0.

2003-01-06  Philip Blundell  <philb@gnu.org>

	* Version 0.32 released.

2003-01-06  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* Makefile: delete year_view

2003-01-06  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* gpe-calendar.session: add a Xsession.d file to schedule
	next alarms at login time 
	* Makefile: install new Xsession.d file

2003-01-06  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* event-db.c (event_sort_func): add a "recur" sort_func so we
	can reverse-sort recurring by enddate and skip ones with old
	end dates, also add ALARM flag to cloned events 
	* event-ui.c (schedule_alarm): change schedule alarm to have a
	date input as well as event_t input (so we can do recurring 
	alarms), add schedule_next function; use schedule_next function
	INSTEAD of schedule_alarm in editted and new events
	* event-ui.h : add schedule_next function
	* main.c (main): add getopt stuff to read -s flag, erase 
	year_view stuff, add schedule_next stuff at init and at exit,
	get rid of render_icon

2003-01-06  Philip Blundell  <philb@gnu.org>

	* Makefile (LDFLAGS): Add -L../libdm -ldm.
	(CFLAGS): Add -I../libdm
	* main.c (main): Call libdm_init.  Mark window for migration.

2003-01-05  Luis Oliveira  <luis@handhelds.org>

	* First steps towards libgpeeventdb.
	* event-db.c (event_db_refresh): New function.
	  (event_db_stop): Free event lists.
	* globals.h event-db.h: Moved some defines from globals.h to
	event-db.h

2003-01-05  Philip Blundell  <philb@gnu.org>

	* familiar/control1 (Version): Version 0.31 released.

2003-01-05  Philip Blundell  <philb@gnu.org>

	* event-db.c (event_db_clone): Add missing memcpy, duh.

2003-01-05  Philip Blundell  <philb@gnu.org>

	* familiar/control1 (Version): Version 0.30 released.

2003-01-05  Philip Blundell  <philb@gnu.org>

	* month_view.c (button_press): Ignore clicks other than button 1.
	(month_view): Select for release events.

	* xsettings.c (notify_func): Only act on CHANGED or NEW messages.

2003-01-04  Philip Blundell  <philb@gnu.org>

	* event-db.h (event_db__alloc_event): New.
	(event_db__alloc_recur): Likewise.
	(event_db__free_event): Likewise.
	(event_db__free_recur): Likewise.
	(EVENT_DB_USE_MEMCHUNK): Likewise.  Default on.
	* event-db.c (event_db_start): Create new GMemChunks.
	(load_callback): Use above macros.
	(event_db_clone): Likewise.
	(event_db_new): Likewise.
	(event_db_destroy): Likewise.
	(event_db_destroy_clone): Likewise.
	(event_db_get_recurrence): Likewise.
	* old-db.c (load_callback0): Likewise.
	
2003-01-04  Philip Blundell  <philb@gnu.org>

	* Version 0.29 released.
	
2003-01-04  Philip Blundell  <philb@gnu.org>

	* main.c (button_toggled): Only act when button is active.

	* event-db.c (event_db_clone): New.
	(event_db_list_for_period_internal): Use it.  Reformat.
	Reorganise handling of max-events.
	(get_ev_from_uid): Rename to ...
	(event_db_find_by_uid): ... this.  All callers updated.
	* event-db.h (event_db_clone): New prototype.
	(get_ev_from_uid): Rename to event_db_find_by_uid.

	* day_popup.c (day_popup): Mark string for translation.
	
2003-01-03  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

        * event-db.h : add FLAGS for RECUR and CLONE 
	* day_popup.c (selection_made & day_popup): attach uid to row so 
	we can grab the uncloned event_t (also fix small warning on 
	SIGNAL_FUNC)
	* day_view.c (selection_made & day_view_update): attach uid to row so 
	we can grab the uncloned event_t
	* event-db.c (event_db_list_for_period_internal): losts of changes 
	here and elsewhere to add cloned records; highlights -> new 
	routines get_ev_from_uid, event_db_destroy_clone; remove clones
	when doing event_db_list_destroy, *will now be able to get event-list
	IN ORDER, so we can implement next_alarm!*
	* event-ui.c (edit_event): small warning fix, and silly fix for recur
	toggle buttons
	* future_view.c (selection_made & future_view_update): attach uid to 
	row so we can grab the uncloned event_t (also warning fix)
	 * main.c : change default font slightly	
	
2003-01-01  Philip Blundell  <philb@gnu.org>

	* Version 0.28 released.

2003-01-01  Philip Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Tasks are not yet properly
	implemented; don't offer them on the menu.

2003-01-01  Philip Blundell  <philb@gnu.org>

	* event-ui.c (build_edit_event_window): Set week-starts-monday
	flag on newly created GtkDateCombo widgets.
	(build_edit_event_window): Set default size for window.

	* xsettings.c (gpe_calendar_start_xsettings): Use gpe_error_box.
	(watch_func): Reformat decl.
	(notify_func): Likewise.  Make key names case insensitive.  Add
	GPE/week-starts-monday as synonym for old key under GPE/Calendar.
	(KEY_BASE): Set to "GPE/".

	* gpe-calendar.desktop (SingleInstance): Set to true.

	* main.c (my_icons): Add close.
	(main): Use gpe_set_window_icon.  Add more verbose tooltips.

	* day_popup.c (day_popup): Replace cancel pixmap with close.  Pack
	buttons with no padding.  Put a frame around the window contents.
	(destroy_popup): Reformat.
	(close_window): Likewise.
	(day_clicked): Likewise.
	(selection_made): Likewise.
	
	* event-ui.c (new_event): Set window title.
	(edit_event): Likewise.
	(build_edit_event_window): Set icon for window.

	* main.c (main): Remove call to event_ui_init.

2002-12-19  Philip Blundell  <philb@gnu.org>

	* Version 0.27 released.

2002-12-15  Luis Oliveira  <luis@handhelds.org>

	* po/pt_PT.po: Updated translation.

2002-12-15  Philip Blundell  <philb@gnu.org>

	* po/pt_PT.po: Set character set to iso-8859-15.

2002-10-31  Luis Oliveira  <luis@handhelds.org>

       * event-db.c (event_db_destroy): Fix memory leak.

2002-12-07  Philip Blundell  <philb@gnu.org>

	* month_view.c (draw_expose_event): Remove unused variable.
	* event-db.c (insert_values): Remove spurious token-paste.

2002-12-06  Philip Blundell  <philb@gnu.org>

	* gpe-calendar.desktop: New file.
	* Makefile (install): Install it.
	Patch from Matthew Allum <breakfast@10.am>

2002-11-30  Philip Blundell  <philb@gnu.org>

	* Version 0.26 released.

2002-11-30  Philip Blundell  <philb@gnu.org>

	* day_view.c (day_view_update): Set scroll position to current
	hour.
	(scroll_adjustment): New global.
	(day_view): Initialise it.

	* event-ui.c (edit_event): Explicitly set state of more widgets.
	(new_event): Likewise.

	* event-ui.c (build_edit_event_window): Use GtkTextView for
	description under GTK 2.
	(click_ok): Likewise.
	(new_event): Likewise.
	(edit_event): Likewise.

	* Makefile (GTKCFLAGS): Remove -DGTK_ENABLE_BROKEN.

	* event-ui.c (build_edit_event_window): Adjust GtkSimpleMenu
	signal naming.

	* main.c (main): Call event_ui_init.
	* event-ui.h (event_ui_init): Add prototype.
	* event-ui.c (event_ui_init): New function.
	(build_edit_event_window): Renamed from edit_event_window.
	(edit_event_window): New function; wrap the above.
	(edit_finished): New function.
	(click_delete): Call it.
	(click_ok): Likewise.
	(click_cancel): Likewise.

2002-11-29  Philip Blundell  <philb@gnu.org>

	* day_view.c (selection_made): Set viewtime when a row is single
	clicked.

2002-10-17  Philip Blundell  <philb@gnu.org>

	* Version 0.25 released.

2002-10-17  Philip Blundell  <philb@gnu.org>

	* main.c (main): Call gpe_calendar_start_xsettings.
	(day_view_combined_times): Define.
	* xsettings.c: New file.
	* globals.h (day_view_combined_times): Declare.
	* day_view.c (day_view_combined_times): Don't define.
	* Makefile (MEMBERS): Add xsettings.
	* Makefile (LDFLAGS): Add Xsettings libraries.
	* Makefile (CFLAGS): Add Xsettings include paths.
	
2002-10-14  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

        * event-ui.c (schedule_alarm): add DISPLAY to script 

2002-10-13  Philip Blundell  <philb@gnu.org>

	* week_view.c (draw_expose_event): Format time correctly.
	(week_view_update): Likewise.

2002-10-12  Philip Blundell  <philb@gnu.org>

	* week_view.c (draw_expose_event): Only draw black separator when
	appropriate to do so.
	(week_view_update): Put untimed events at start of list.
	Calculate required height appropriately for Pango.

	* main.c (main): Put all views inside a GtkNotebook.
	(new_view): Select the appropriate page.

2002-10-12  Philip Blundell  <philb@gnu.org>

	* Makefile (GTK2): Default is yes.

	* main.c (main): Fix warnings.

	* week_view.c: Switch back to drawing area implementation.

2002-10-07  Philip Blundell  <philb@gnu.org>

	* event-ui.c (edit_event_window): Fix memory leak.

2002-10-06  Philip Blundell  <philb@gnu.org>

	* Version 0.23 released.

2002-10-06  Philip Blundell  <philb@gnu.org>

	* Makefile: Add support for GTK 2.
	* day_view.c (day_view_update): Likewise.
	* future_view.c (future_view_update): Likewise.
	* month_view.c (draw_expose_event): Likewise.
	* main.c (main): Likewise.
	* familiar/control1: New file.

	* Makefile (DEBUG): Default off.

	* month_view.c (button_press): Reject clicks outside valid area.
	[Bug #130]
	(resize_table): Calculate height on the basis of 7 rows.  
	[Bug #133]

	* main.c (main): Use radio buttons for view selection, based on
	patch from pigeon@pigeond.net.
	(set_week_view, set_month_view, set_year_view, set_future_view): Deleted.

2002-10-04  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* event-db.c (event_db_list_for_period_internal: erase
	the "max &&" and "/*skip already finished events */" 
	parts got cut	
	* future-view.c: change to use list_for_future()

2002-09-29  Philip Blundell  <philb@gnu.org>

	* day_view.c (format_event): Handle untimed events.  Elide end
	time if duration is zero.
	(day_view_update): Handle untimed events appropriately.

	* event-db.c (event_db_new): Zero newly allocated structure.

2002-09-29  Philip Blundell  <philb@gnu.org>

	* event-db.c (event_db_list_for_period_internal): New parameters
	"max", "untimed_significant".
	(event_db_list_for_period): Update call to above function.
	(event_db_untimed_list_for_period): Likewise.
	(event_db_list_for_future): New.

	* event-db.h (event_db_list_for_future): New prototype.
	
2002-09-29  Philip Blundell  <philb@gnu.org>

	* event-db.h (recur_t): New, broken out from event_t.
	(event_t): Member "recur" is now a pointer.
	(event_db_get_recurrence): New prototype.
	* event-db.c (events): Separate back into recurring_events and
	one_shot_events.
	(event_db_add_internal): Use appropriate list.
	(event_db_remove_internal): Likewise.
	(load_data_callback): Allocate ev->recur when required.
	(load_callback): Free recurrence struct if it was allocated by
	mistake.
	(event_db_list_for_period_internal): Use separate one-shot and
	recurring lists.  Cope with ev->recur as a pointer.
	(event_db_write): Only write recurrence tags for recurring events.
	Cope with ev->recur as a pointer.
	(event_db_destroy): Free recurrence struct if it exists.
	(event_db_get_recurrence): New.
	* day_view.c (day_view_update): Fix formatting.  Just test
	ev->recur, not ev->recur.type.
	* old-db.c (load_callback0): No need to set recurrence type.
	* event-ui.c (click_ok): Allocate or dispose of recurrence struct
	as appropriate.  Fix formatting.  Use "for" loop for day-related
	tests.
	(edit_event): Fix formatting.  Expect ev->recur as a pointer.  Use
	"for" loop for day masking.

2002-09-26  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* Makefile: drop libgpe dependencies	
	* event-ui.h: change to atd for alarms	
	* event-ui.c: change to atd for alarms	
	* day-view.c: add pixmaps for recurring and alarms	
	* year-view.c: delete unused variable	

	* Version 0.22 released.

2002-09-09  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* month-view.c: fix daylight savings glitch
	
	* year-view.c: same	

2002-09-08  Philip Blundell  <philb@gnu.org>

	* event-ui.c (struct edit_state): Add taskdate, taskspin,
	optionmenutype, optionmenutask.
	(set_notebook_page): Operate on GtkSimpleMenu.
	(edit_event_window): Use GtkSimpleMenu for type selection.  Add
	preliminary support for "tasks".

2002-09-06  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* event-ui.c: add rtcd support for alarms and re-show alarm notepage
	WE NEED TO FIX THIS PRIOR TO OUR NEXT RELEASE SINCE THE RTCD IS A HACK!
	
	* event-ui.h: alarm stuff	

2002-09-05  Philip Blundell  <philb@gnu.org>

	* main.c (main): Reinstate yearfont, datefont.
	* globals.h: Likewise.
	* year_view.c: Roll back to non-GtkCalendar version.

	* day_popup.c (day_popup): Call mktime to calculate day of week
	correctly.

2002-09-04  Philip Blundell  <philb@gnu.org>

	* Version 0.20 released.

2002-09-02  Philip Blundell  <philb@gnu.org>

	* event-ui.c (new_event): Fix calculation of end time when
	wrapping from one day to the next.
	(struct edit_state): Add notebooktype, page.
	(click_ok): Distinguish appointments and reminders.
	(set_notebook_page): Set s->page.
	(edit_event_window): Pass edit_state as argument to above
	function.
	* main.c (new_appointment): Use viewtime, not current time.

2002-09-01  Philip Blundell  <philb@gnu.org>

	* event-ui.c (struct edit_state): Delete alldaybutton.  Add
	reminderdate, remindertime, remindertimebutton.
	(recalculate_sensitivities): Replace alldaybutton with
	remindertimebutton.
	(set_notebook_page): New.
	(edit_event_window): Distinguish between "appointments" and
	"reminders".

2002-08-31  Philip Blundell  <philb@gnu.org>

	* event-ui.c (edit_event_window): Put event box in a
	GtkScrolledWindow.

2002-08-31  Philip Blundell  <philb@gnu.org>

	* month_view.c (c_old): Make static.
	(button_press): Fix formatting.
	(struct render_ctl): Add "today".
	(draw_expose_event): Draw red border when c->today==TRUE.
	(month_view_update): Set c->today appropriately.

2002-08-31  Philip Blundell  <philb@gnu.org>

	* month_view.c (TOTAL_DAYS): New macro.
	(draw_expose_event): Use it.
	(month_view_update): Likewise.
	(rc): Use TOTAL_DAYS as array size.

2002-08-31  Philip Blundell  <philb@gnu.org>

	* event-db.c (event_db_alloc_details): Add refcount.
	(event_db_forget_details): Likewise.
	(event_db_get_details): Likewise.
	(event_db_write): Use event_db_get_details and
	event_db_forget_details.  Reduce size of string buffers.  Use
	sizeof where appropriate.  Take "sequence" and "modified" from
	details struct, not event_t.
	* event-db.h (event_details_s): Add ref, sequence, modified.
	(event_s): Remove sequence, modified.
	* event-ui.c (click_ok): Call event_db_forget_details.  Use
	ev_d->sequence not ev->sequence.

2002-08-30  Philip Blundell  <philb@gnu.org>

	* event-db.h (event_s): Add "sequence".
	* event-db.c (event_db_write): Write out SEQUENCE tag.
	(load_data_callback): Read it back in again.

	* event-ui.c (click_ok): Bump sequence number on existing events.

2002-08-30  Philip Blundell  <philb@gnu.org>

	* event_db.h (struct calendar_time_s): New struct.

2002-08-30  Philip Blundell  <philb@gnu.org>

	* event-ui.c (struct edit_state): Delete "old_alarm".
	(click_ok): Replace test of s->old_alarm with direct inspection of
	ev->flags.
	(edit_event): Don't set s->old_alarm;
	(new_event): Likewise.
	(recalculate_sensitivities): Fix formatting.

2002-08-30  Philip Blundell  <philb@gnu.org>

	* event-ui.c (click_ok): Reuse old event structure when modifying
	an existing event.
	* event-db.c (event_db_write): New function.
	(event_db_flush): Likewise.
	(event_db_add): Use event_db_write.
	(insert_values): Expect err as char**.
	* event-db.h (event_db_flush): New prototype.

2002-08-30  Philip Blundell  <philb@gnu.org>

	* event-db.h (FLAG_TENTATIVE): New.
	(calendar_time_t): New type.
	(event_t): Delete "confirmed".  Change type of "start" to 
	calendar_time_t.

	* event-ui.c (click_delete): Test for flags & FLAG_ALARM.
	(edit_event): Likewise.
	(click_ok): Likewise.  Set FLAG_ALARM bit appropriately.

2002-08-29  Philip Blundell  <philb@gnu.org>

	* event-db.c (parse_date): Don't dereference date_only if NULL.
	(load_data_callback): Pass "date_only" as NULL to above function
	when not interested in that information.

	* globals.h (timefont, datefont, yearfont, DO_RECURRENCE): Delete
	obsolete cruft.

2002-08-25  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* old-db.c: fix for when no db exists.
	
	* event-db.c: include recurrence and fix deleting.
	
	* event-db.h: small schema change for recurrence.
	
	* event-ui.c: include recurrence.
	
	* globals.h: include recurrence bit thingies.
	
2002-08-25  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* old-db.c: write new schema version to db after update.
	
	* event-db.c: Use new database schema versioning.
	
2002-08-26  Philip Blundell  <philb@gnu.org>

	* event-db.c (parse_date): New function.
	(load_data_callback): Use it.

2002-08-25  Philip Blundell  <philb@gnu.org>

	* day_popup.c (day_popup): Return GtkWidget*.
	* day_popup.h (day_popup): Adjust prototype to match.

	* old-db.c: New file.
	* Makefile (MEMBERS): Add old-db.

	* event-db.c: Use new database schema.
	* event-db.h (FLAG_ALARM): New.

2002-08-23  Philip Blundell  <philb@gnu.org>

	* Makefile (DEBUG): Default off.
	* main.c (main): Remove historical font-loading cruft.

2002-08-22  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* day_view.c (day_view_update, update_hooks_callback): move set_time.
	* week_view.c (week_view_update, update_hooks_callback): Likewise.	
	* month_view.c (month__view_update, update_hooks_callback): Likewise.
	* year_view.c (year_view_update, update_hooks_callback): Likewise.
	
2002-08-05  Colin Marquardt  <colin@marquardt-home.de>

	* po/Makefile (translation-package): Get control and postinst from
	control.translation and postinst.translation.

	* Makefile (translation-package): New target to automatically
	make translation packages. Just calls the same target in po/Makefile.

	* po/Makefile (translation-package): New target to automatically
	make translation packages. This actually does all the work.

2002-07-31  Philip Blundell  <philb@gnu.org>

	* main.c: Remove useless include of gdk_imlib.h

2002-07-29  Colin Marquardt  <colin@marquardt-home.de>

	* gpe-calendar.menu: Give full path for the icon. Move to section
	PIM (to conform to http://familiar.handhelds.org/policy/menu.html)

2002-07-17  Philip Blundell  <pb@nexus.co.uk>

	* Version 0.10 released

2002-07-13  Philip Blundell  <philb@gnu.org>

	* main.c (main): Remove call to what_init.

2002-07-09  Philip Blundell  <philb@gnu.org>

	* Makefile (gpe-calendar): Link with libgpewidget before libgtk.

2002-06-22  Philip Blundell  <philb@gnu.org>

	* main.c (main): Set icon for window manager.

	* event-ui.c (click_ok): Correct DST related lossage.

	* event-db.c (event_db_alloc_details): Pass correct size to
	memset.

	* Version 0.09 released.

2002-06-21  Joseph J. McCarthy  <mccarthy@engrng.pitt.edu>

	* month_view.c (button_press): Use global pop_window pointers so it
	is easier to manipulate the pop-up from a few different routines
	(this will help with the soon-to-be-worked-on new year-view as well).

	* globals.h : Add a new global for the pop-up windows (so they are
	easier to kill).

	* main.c : Add a new global for the pop-up windows (so they are
	easier to kill).

	* day_popup.c (destroy_popup): Set global pop_window pointer to NULL
	when window is killed

	* Version 0.08 released.

2002-06-21  Philip Blundell  <pb@debian.org>

	* month_view.c (draw_expose_event): Draw days with events as
	gray60 background and white text.  Unref newly created GCs when
	done with them.

	* event-ui.c (click_ok): Disallow end time earlier than start time.

	* familiar/control (Depends): Require libgpewidget 0.08.  Remove
	explicit dependency on gdk-pixbuf2.

	* Version 0.08 released.

2002-06-20  Philip Blundell  <pb@debian.org>

	* main.c (main): Call what_init.

2002-06-18  Philip Blundell  <pb@debian.org>

	* day_popup.c (day_popup): Realize widget before using its style.
	Add missing include.
	* event-ui.c (edit_event_window): Likewise.
	* main.c: Add missing include.

2002-06-16  Philip Blundell  <pb@debian.org>

	* main.c (my_pix): Add "cancel".
	* day_popup.c (day_popup): Use gpe_find_pixmap.

2002-06-15  Philip Blundell  <pb@debian.org>

	* Makefile: Don't link with gdk-imlib.
	(MEMBERS): Remove about.
	* about.c: Obsolete, deleted.
